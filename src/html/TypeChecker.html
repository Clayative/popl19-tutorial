<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>TypeChecker</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Type checker for the WHILE language.</a>

<a id="42" class="Symbol">{-#</a> <a id="46" class="Keyword">OPTIONS</a> <a id="54" class="Pragma">--sized-types</a> <a id="68" class="Symbol">#-}</a>
<a id="72" class="Symbol">{-#</a> <a id="76" class="Keyword">OPTIONS</a> <a id="84" class="Pragma">--postfix-projections</a> <a id="106" class="Symbol">#-}</a>

<a id="111" class="Keyword">module</a> <a id="118" href="TypeChecker.html" class="Module">TypeChecker</a> <a id="130" class="Keyword">where</a>

<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Library.html" class="Module">Library</a>

<a id="158" class="Keyword">import</a> <a id="165" href="AST.html" class="Module">AST</a> <a id="169" class="Symbol">as</a> <a id="172" class="Module">A</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="WellTypedSyntax.html" class="Module">WellTypedSyntax</a>

<a id="203" class="Comment">-- Names as coming from the abstract syntax are just strings.</a>

<a id="Name"></a><a id="266" href="TypeChecker.html#266" class="Function">Name</a> <a id="271" class="Symbol">=</a> <a id="273" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="idToName"></a><a id="281" href="TypeChecker.html#281" class="Function">idToName</a> <a id="290" class="Symbol">:</a> <a id="292" href="AST.html#309" class="Datatype">A.Id</a> <a id="297" class="Symbol">→</a> <a id="299" href="TypeChecker.html#266" class="Function">Name</a>
<a id="304" href="TypeChecker.html#281" class="Function">idToName</a> <a id="313" class="Symbol">(</a><a id="314" href="AST.html#326" class="InductiveConstructor">A.mkId</a> <a id="321" href="TypeChecker.html#321" class="Bound">x</a><a id="322" class="Symbol">)</a> <a id="324" class="Symbol">=</a> <a id="326" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="342" href="TypeChecker.html#321" class="Bound">x</a>

<a id="345" class="Comment">-- Local context for the type checker.</a>

<a id="TCCxt"></a><a id="385" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="391" class="Symbol">:</a> <a id="393" class="Symbol">(</a><a id="394" href="TypeChecker.html#394" class="Bound">Γ</a> <a id="396" class="Symbol">:</a> <a id="398" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="401" class="Symbol">)</a> <a id="403" class="Symbol">→</a> <a id="405" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="409" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="415" href="TypeChecker.html#415" class="Bound">Γ</a> <a id="417" class="Symbol">=</a> <a id="419" href="Library.List.html#1386" class="Function">AssocList</a> <a id="429" href="TypeChecker.html#266" class="Function">Name</a> <a id="434" href="TypeChecker.html#415" class="Bound">Γ</a>

<a id="437" class="Comment">-- Querying the local context.</a>

<a id="469" class="Comment">-- Type errors.</a>
<a id="485" class="Comment">--</a>
<a id="488" class="Comment">-- Currently, these errors do not carry enough evidence that</a>
<a id="549" class="Comment">-- something is wrong.  The type checker does not produce</a>
<a id="607" class="Comment">-- evidence of ill-typedness in case of failure,</a>
<a id="656" class="Comment">-- only of well-typedness in case of success.</a>

<a id="703" class="Keyword">data</a> <a id="TypeError"></a><a id="708" href="TypeChecker.html#708" class="Datatype">TypeError</a> <a id="718" class="Symbol">:</a> <a id="720" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="724" class="Keyword">where</a>
  <a id="TypeError.unboundVariable"></a><a id="732" href="TypeChecker.html#732" class="InductiveConstructor">unboundVariable</a>        <a id="755" class="Symbol">:</a> <a id="757" href="TypeChecker.html#266" class="Function">Name</a> <a id="762" class="Symbol">→</a> <a id="764" href="TypeChecker.html#708" class="Datatype">TypeError</a>
  <a id="TypeError.typeMismatch"></a><a id="776" href="TypeChecker.html#776" class="InductiveConstructor">typeMismatch</a>           <a id="799" class="Symbol">:</a> <a id="801" class="Symbol">(</a><a id="802" href="TypeChecker.html#802" class="Bound">tinf</a> <a id="807" href="TypeChecker.html#807" class="Bound">texp</a> <a id="812" class="Symbol">:</a> <a id="814" href="AST.html#399" class="Datatype">Type</a><a id="818" class="Symbol">)</a>  <a id="821" class="Symbol">→</a> <a id="823" href="TypeChecker.html#802" class="Bound">tinf</a> <a id="828" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="830" href="TypeChecker.html#807" class="Bound">texp</a> <a id="835" class="Symbol">→</a> <a id="837" href="TypeChecker.html#708" class="Datatype">TypeError</a>

<a id="848" class="Keyword">instance</a>
  <a id="PrintError"></a><a id="859" href="TypeChecker.html#859" class="Function">PrintError</a> <a id="870" class="Symbol">:</a> <a id="872" href="Library.Print.html#196" class="Record">Print</a> <a id="878" href="TypeChecker.html#708" class="Datatype">TypeError</a>
  <a id="890" href="Library.Print.html#244" class="Field">print</a> <a id="896" class="Symbol">{{</a><a id="898" href="TypeChecker.html#859" class="Function">PrintError</a><a id="908" class="Symbol">}}</a> <a id="911" class="Symbol">=</a> <a id="913" class="Symbol">λ</a> <a id="915" class="Keyword">where</a>
    <a id="925" class="Symbol">(</a><a id="926" href="TypeChecker.html#732" class="InductiveConstructor">unboundVariable</a> <a id="942" href="TypeChecker.html#942" class="Bound">x</a><a id="943" class="Symbol">)</a>        <a id="952" class="Symbol">→</a> <a id="954" class="String">&quot;unbound variable &quot;</a> <a id="974" href="Data.String.Base.html#2425" class="Function Operator">String.++</a> <a id="984" href="TypeChecker.html#942" class="Bound">x</a>
    <a id="990" class="Symbol">(</a><a id="991" href="TypeChecker.html#776" class="InductiveConstructor">typeMismatch</a> <a id="1004" href="TypeChecker.html#1004" class="Bound">tinf</a> <a id="1009" href="TypeChecker.html#1009" class="Bound">texp</a> <a id="1014" class="Symbol">_)</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Data.String.Base.html#2613" class="Function">String.concat</a> <a id="1033" href="Function.Base.html#1974" class="Function Operator">$</a>
      <a id="1041" class="String">&quot;type mismatch: expected &quot;</a> <a id="1068" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1070" href="Library.Print.html#244" class="Field">print</a> <a id="1076" href="TypeChecker.html#1009" class="Bound">texp</a> <a id="1081" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
      <a id="1089" class="String">&quot;, but inferred &quot;</a> <a id="1107" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1109" href="Library.Print.html#244" class="Field">print</a> <a id="1115" href="TypeChecker.html#1004" class="Bound">tinf</a> <a id="1120" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1122" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="1126" class="Comment">-- Type error monad.</a>

<a id="1148" class="Keyword">open</a> <a id="1153" href="Library.Error.html#134" class="Module">ErrorMonad</a> <a id="1164" class="Symbol">{</a><a id="1165" class="Argument">E</a> <a id="1167" class="Symbol">=</a> <a id="1169" href="TypeChecker.html#708" class="Datatype">TypeError</a><a id="1178" class="Symbol">}</a>

<a id="1181" class="Comment">-- Checking expressions</a>
<a id="1205" class="Comment">---------------------------------------------------------------------------</a>

<a id="1282" class="Comment">-- During checking of expressions, the context is fixed.</a>

<a id="1340" class="Keyword">module</a> <a id="CheckExpressions"></a><a id="1347" href="TypeChecker.html#1347" class="Module">CheckExpressions</a> <a id="1364" class="Symbol">{</a><a id="1365" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="1367" class="Symbol">:</a> <a id="1369" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="1372" class="Symbol">}</a> <a id="1374" class="Symbol">(</a><a id="1375" href="TypeChecker.html#1375" class="Bound">γ</a> <a id="1377" class="Symbol">:</a> <a id="1379" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="1385" href="TypeChecker.html#1365" class="Bound">Γ</a><a id="1386" class="Symbol">)</a> <a id="1388" class="Keyword">where</a>

  <a id="1397" class="Comment">-- Environment.</a>

  <a id="CheckExpressions.lookupVar"></a><a id="1416" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="1426" class="Symbol">:</a> <a id="1428" class="Symbol">(</a><a id="1429" href="TypeChecker.html#1429" class="Bound">x</a> <a id="1431" class="Symbol">:</a> <a id="1433" href="TypeChecker.html#266" class="Function">Name</a><a id="1437" class="Symbol">)</a> <a id="1439" class="Symbol">→</a> <a id="1441" href="Library.Error.html#170" class="Function">Error</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="1450" class="Symbol">λ</a> <a id="1452" href="TypeChecker.html#1452" class="Bound">t</a> <a id="1454" class="Symbol">→</a> <a id="1456" href="WellTypedSyntax.html#296" class="Function">Var</a> <a id="1460" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="1462" href="TypeChecker.html#1452" class="Bound">t</a><a id="1463" class="Symbol">)</a>
  <a id="1467" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="1477" href="TypeChecker.html#1477" class="Bound">x</a> <a id="1479" class="Symbol">=</a>
    <a id="1485" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="1490" href="Library.List.html#1819" class="Function Operator">?↦</a> <a id="1493" href="TypeChecker.html#1477" class="Bound">x</a> <a id="1495" href="Library.List.html#1819" class="Function Operator">∈</a> <a id="1497" href="TypeChecker.html#1375" class="Bound">γ</a> <a id="1499" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="1502" class="Symbol">λ</a> <a id="1504" class="Keyword">where</a>
      <a id="1516" class="Symbol">(</a><a id="1517" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="1521" class="Symbol">(</a><a id="1522" href="TypeChecker.html#1522" class="Bound">t</a> <a id="1524" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1526" href="TypeChecker.html#1526" class="Bound">x&#39;</a> <a id="1529" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1531" class="Symbol">_))</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="Library.Monad.html#1110" class="Function">return</a> <a id="1544" class="Symbol">(</a><a id="1545" href="TypeChecker.html#1522" class="Bound">t</a> <a id="1547" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1549" href="TypeChecker.html#1526" class="Bound">x&#39;</a><a id="1551" class="Symbol">)</a>
      <a id="1559" class="Symbol">(</a><a id="1560" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1563" href="TypeChecker.html#1563" class="Bound">¬p</a><a id="1565" class="Symbol">)</a>            <a id="1578" class="Symbol">→</a> <a id="1580" href="Library.Error.html#912" class="Function">throwError</a> <a id="1591" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1593" href="TypeChecker.html#732" class="InductiveConstructor">unboundVariable</a> <a id="1609" href="TypeChecker.html#1477" class="Bound">x</a>

  <a id="1614" class="Comment">-- The expression checker.</a>

  <a id="1644" class="Keyword">mutual</a>

    <a id="1656" class="Comment">-- Type inference.</a>

    <a id="CheckExpressions.inferExp"></a><a id="1680" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1689" class="Symbol">:</a> <a id="1691" class="Symbol">(</a><a id="1692" href="TypeChecker.html#1692" class="Bound">e</a> <a id="1694" class="Symbol">:</a> <a id="1696" href="AST.html#611" class="Datatype">A.Exp</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Library.Error.html#170" class="Function">Error</a> <a id="1711" class="Symbol">(</a><a id="1712" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="1714" class="Symbol">λ</a> <a id="1716" class="Symbol">(</a><a id="1717" href="TypeChecker.html#1717" class="Bound">t</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="AST.html#399" class="Datatype">Type</a><a id="1725" class="Symbol">)</a> <a id="1727" class="Symbol">→</a> <a id="1729" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="1733" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="1735" href="TypeChecker.html#1717" class="Bound">t</a><a id="1736" class="Symbol">)</a>

    <a id="1743" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1752" class="Symbol">(</a><a id="1753" href="AST.html#674" class="InductiveConstructor">A.eInt</a> <a id="1760" href="TypeChecker.html#1760" class="Bound">i</a><a id="1761" class="Symbol">)</a>  <a id="1764" class="Symbol">=</a> <a id="1766" href="Library.Monad.html#1110" class="Function">return</a> <a id="1773" class="Symbol">(</a><a id="1774" href="AST.html#423" class="InductiveConstructor">int</a>  <a id="1779" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1781" href="WellTypedSyntax.html#579" class="InductiveConstructor">eInt</a>  <a id="1787" href="TypeChecker.html#1760" class="Bound">i</a><a id="1788" class="Symbol">)</a>
    <a id="1794" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1803" class="Symbol">(</a><a id="1804" href="AST.html#719" class="InductiveConstructor">A.eBool</a> <a id="1812" href="TypeChecker.html#1812" class="Bound">b</a><a id="1813" class="Symbol">)</a> <a id="1815" class="Symbol">=</a> <a id="1817" href="Library.Monad.html#1110" class="Function">return</a> <a id="1824" class="Symbol">(</a><a id="1825" href="AST.html#418" class="InductiveConstructor">bool</a> <a id="1830" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1832" href="WellTypedSyntax.html#641" class="InductiveConstructor">eBool</a> <a id="1838" href="TypeChecker.html#1812" class="Bound">b</a><a id="1839" class="Symbol">)</a>

    <a id="1846" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1855" class="Symbol">(</a><a id="1856" href="AST.html#629" class="InductiveConstructor">A.eId</a> <a id="1862" href="TypeChecker.html#1862" class="Bound">x</a><a id="1863" class="Symbol">)</a> <a id="1865" class="Symbol">=</a> <a id="1867" class="Keyword">do</a>
      <a id="1876" class="Symbol">(</a><a id="1877" href="TypeChecker.html#1877" class="Bound">t</a> <a id="1879" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1881" href="TypeChecker.html#1881" class="Bound">x&#39;</a><a id="1883" class="Symbol">)</a> <a id="1885" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="1887" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="1897" class="Symbol">(</a><a id="1898" href="TypeChecker.html#281" class="Function">idToName</a> <a id="1907" href="TypeChecker.html#1862" class="Bound">x</a><a id="1908" class="Symbol">)</a>
      <a id="1916" href="Library.Monad.html#1110" class="Function">return</a> <a id="1923" class="Symbol">(</a><a id="1924" href="TypeChecker.html#1877" class="Bound">t</a> <a id="1926" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1928" href="WellTypedSyntax.html#797" class="InductiveConstructor">eVar</a> <a id="1933" href="TypeChecker.html#1881" class="Bound">x&#39;</a><a id="1935" class="Symbol">)</a>

    <a id="1942" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1951" class="Symbol">(</a><a id="1952" href="AST.html#764" class="InductiveConstructor">A.ePlus</a>  <a id="1961" href="TypeChecker.html#1961" class="Bound">e₁</a> <a id="1964" href="TypeChecker.html#1964" class="Bound">e₂</a><a id="1966" class="Symbol">)</a> <a id="1968" class="Symbol">=</a> <a id="1970" href="TypeChecker.html#2436" class="Function">inferOp</a> <a id="1978" href="WellTypedSyntax.html#411" class="InductiveConstructor">plus</a>  <a id="1984" href="TypeChecker.html#1961" class="Bound">e₁</a> <a id="1987" href="TypeChecker.html#1964" class="Bound">e₂</a>

    <a id="1995" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2004" class="Symbol">(</a><a id="2005" href="AST.html#809" class="InductiveConstructor">A.eGt</a>    <a id="2014" href="TypeChecker.html#2014" class="Bound">e₁</a> <a id="2017" href="TypeChecker.html#2017" class="Bound">e₂</a><a id="2019" class="Symbol">)</a> <a id="2021" class="Symbol">=</a> <a id="2023" href="TypeChecker.html#2436" class="Function">inferOp</a> <a id="2031" href="WellTypedSyntax.html#433" class="InductiveConstructor">gt</a>    <a id="2037" href="TypeChecker.html#2014" class="Bound">e₁</a> <a id="2040" href="TypeChecker.html#2017" class="Bound">e₂</a>

    <a id="2048" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2057" class="Symbol">(</a><a id="2058" href="AST.html#854" class="InductiveConstructor">A.eAnd</a>   <a id="2067" href="TypeChecker.html#2067" class="Bound">e₁</a> <a id="2070" href="TypeChecker.html#2070" class="Bound">e₂</a><a id="2072" class="Symbol">)</a> <a id="2074" class="Symbol">=</a> <a id="2076" href="TypeChecker.html#2436" class="Function">inferOp</a> <a id="2084" href="WellTypedSyntax.html#456" class="InductiveConstructor">and</a>   <a id="2090" href="TypeChecker.html#2067" class="Bound">e₁</a> <a id="2093" href="TypeChecker.html#2070" class="Bound">e₂</a>

    <a id="2101" class="Comment">-- Type checking.</a>
    <a id="2123" class="Comment">-- Calls inference and checks inferred type against given type.</a>

    <a id="CheckExpressions.checkExp"></a><a id="2192" href="TypeChecker.html#2192" class="Function">checkExp</a> <a id="2201" class="Symbol">:</a> <a id="2203" class="Symbol">(</a><a id="2204" href="TypeChecker.html#2204" class="Bound">e</a> <a id="2206" class="Symbol">:</a> <a id="2208" href="AST.html#611" class="Datatype">A.Exp</a><a id="2213" class="Symbol">)</a> <a id="2215" class="Symbol">(</a><a id="2216" href="TypeChecker.html#2216" class="Bound">t</a> <a id="2218" class="Symbol">:</a> <a id="2220" href="AST.html#399" class="Datatype">Type</a><a id="2224" class="Symbol">)</a> <a id="2226" class="Symbol">→</a> <a id="2228" href="Library.Error.html#170" class="Function">Error</a> <a id="2234" class="Symbol">(</a><a id="2235" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="2239" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="2241" href="TypeChecker.html#2216" class="Bound">t</a><a id="2242" class="Symbol">)</a>
    <a id="2248" href="TypeChecker.html#2192" class="Function">checkExp</a> <a id="2257" href="TypeChecker.html#2257" class="Bound">e</a> <a id="2259" href="TypeChecker.html#2259" class="Bound">t</a> <a id="2261" class="Symbol">=</a> <a id="2263" class="Keyword">do</a>
      <a id="2272" class="Symbol">(</a><a id="2273" href="TypeChecker.html#2273" class="Bound">t&#39;</a> <a id="2276" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2278" href="TypeChecker.html#2278" class="Bound">e&#39;</a><a id="2280" class="Symbol">)</a> <a id="2282" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2284" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2293" href="TypeChecker.html#2257" class="Bound">e</a>
      <a id="2301" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="2306" href="TypeChecker.html#2273" class="Bound">t&#39;</a> <a id="2309" href="Library.Eq.html#681" class="Field Operator">≟</a> <a id="2311" href="TypeChecker.html#2259" class="Bound">t</a> <a id="2313" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="2316" class="Symbol">λ</a> <a id="2318" class="Keyword">where</a>
        <a id="2332" class="Symbol">(</a><a id="2333" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2337" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2341" class="Symbol">)</a> <a id="2343" class="Symbol">→</a> <a id="2345" href="Library.Monad.html#1110" class="Function">return</a> <a id="2352" href="TypeChecker.html#2278" class="Bound">e&#39;</a>
        <a id="2363" class="Symbol">(</a><a id="2364" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a>  <a id="2368" href="TypeChecker.html#2368" class="Bound">t&#39;≢t</a><a id="2372" class="Symbol">)</a> <a id="2374" class="Symbol">→</a> <a id="2376" href="Library.Error.html#912" class="Function">throwError</a> <a id="2387" class="Symbol">(</a><a id="2388" href="TypeChecker.html#776" class="InductiveConstructor">typeMismatch</a> <a id="2401" href="TypeChecker.html#2273" class="Bound">t&#39;</a> <a id="2404" href="TypeChecker.html#2259" class="Bound">t</a> <a id="2406" href="TypeChecker.html#2368" class="Bound">t&#39;≢t</a><a id="2410" class="Symbol">)</a>

    <a id="2417" class="Comment">-- Operators.</a>

    <a id="CheckExpressions.inferOp"></a><a id="2436" href="TypeChecker.html#2436" class="Function">inferOp</a> <a id="2444" class="Symbol">:</a> <a id="2446" class="Symbol">∀{</a><a id="2448" href="TypeChecker.html#2448" class="Bound">t</a> <a id="2450" href="TypeChecker.html#2450" class="Bound">t&#39;</a><a id="2452" class="Symbol">}</a> <a id="2454" class="Symbol">(</a><a id="2455" href="TypeChecker.html#2455" class="Bound">op</a> <a id="2458" class="Symbol">:</a> <a id="2460" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="2463" href="TypeChecker.html#2448" class="Bound">t</a> <a id="2465" href="TypeChecker.html#2450" class="Bound">t&#39;</a><a id="2467" class="Symbol">)</a> <a id="2469" class="Symbol">(</a><a id="2470" href="TypeChecker.html#2470" class="Bound">e₁</a> <a id="2473" href="TypeChecker.html#2473" class="Bound">e₂</a> <a id="2476" class="Symbol">:</a> <a id="2478" href="AST.html#611" class="Datatype">A.Exp</a><a id="2483" class="Symbol">)</a> <a id="2485" class="Symbol">→</a> <a id="2487" href="Library.Error.html#170" class="Function">Error</a> <a id="2493" class="Symbol">(</a><a id="2494" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="2496" class="Symbol">λ</a> <a id="2498" href="TypeChecker.html#2498" class="Bound">t</a> <a id="2500" class="Symbol">→</a> <a id="2502" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="2506" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="2508" href="TypeChecker.html#2498" class="Bound">t</a><a id="2509" class="Symbol">)</a>
    <a id="2515" href="TypeChecker.html#2436" class="Function">inferOp</a> <a id="2523" class="Symbol">{</a><a id="2524" href="TypeChecker.html#2524" class="Bound">t</a><a id="2525" class="Symbol">}</a> <a id="2527" class="Symbol">{</a><a id="2528" href="TypeChecker.html#2528" class="Bound">t&#39;</a><a id="2530" class="Symbol">}</a> <a id="2532" href="TypeChecker.html#2532" class="Bound">op</a> <a id="2535" href="TypeChecker.html#2535" class="Bound">e₁</a> <a id="2538" href="TypeChecker.html#2538" class="Bound">e₂</a> <a id="2541" class="Symbol">=</a> <a id="2543" class="Keyword">do</a>
      <a id="2552" href="TypeChecker.html#2552" class="Bound">e₁&#39;</a> <a id="2556" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2558" href="TypeChecker.html#2192" class="Function">checkExp</a> <a id="2567" href="TypeChecker.html#2535" class="Bound">e₁</a> <a id="2570" href="TypeChecker.html#2524" class="Bound">t</a>
      <a id="2578" href="TypeChecker.html#2578" class="Bound">e₂&#39;</a> <a id="2582" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2584" href="TypeChecker.html#2192" class="Function">checkExp</a> <a id="2593" href="TypeChecker.html#2538" class="Bound">e₂</a> <a id="2596" href="TypeChecker.html#2524" class="Bound">t</a>
      <a id="2604" href="Library.Monad.html#1110" class="Function">return</a> <a id="2611" class="Symbol">(</a><a id="2612" href="TypeChecker.html#2528" class="Bound">t&#39;</a> <a id="2615" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2617" href="WellTypedSyntax.html#720" class="InductiveConstructor">eOp</a> <a id="2621" href="TypeChecker.html#2532" class="Bound">op</a> <a id="2624" href="TypeChecker.html#2552" class="Bound">e₁&#39;</a> <a id="2628" href="TypeChecker.html#2578" class="Bound">e₂&#39;</a><a id="2631" class="Symbol">)</a>

  <a id="2636" class="Keyword">mutual</a>

    <a id="2648" class="Comment">-- Checking a single statement.</a>

    <a id="CheckExpressions.checkStm"></a><a id="2685" href="TypeChecker.html#2685" class="Function">checkStm</a> <a id="2694" class="Symbol">:</a> <a id="2696" class="Symbol">(</a><a id="2697" href="TypeChecker.html#2697" class="Bound">s</a> <a id="2699" class="Symbol">:</a> <a id="2701" href="AST.html#1181" class="Datatype">A.Stm</a><a id="2706" class="Symbol">)</a> <a id="2708" class="Symbol">→</a> <a id="2710" href="Library.Error.html#170" class="Function">Error</a> <a id="2716" class="Symbol">(</a><a id="2717" href="WellTypedSyntax.html#1156" class="Datatype">Stm</a> <a id="2721" href="TypeChecker.html#1365" class="Bound">Γ</a><a id="2722" class="Symbol">)</a>

    <a id="2729" href="TypeChecker.html#2685" class="Function">checkStm</a> <a id="2738" class="Symbol">(</a><a id="2739" href="AST.html#1199" class="InductiveConstructor">A.sAss</a> <a id="2746" href="TypeChecker.html#2746" class="Bound">x</a> <a id="2748" href="TypeChecker.html#2748" class="Bound">e</a><a id="2749" class="Symbol">)</a> <a id="2751" class="Symbol">=</a> <a id="2753" class="Keyword">do</a>
      <a id="2762" class="Symbol">(</a><a id="2763" href="TypeChecker.html#2763" class="Bound">t</a> <a id="2765" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2767" href="TypeChecker.html#2767" class="Bound">x&#39;</a><a id="2769" class="Symbol">)</a> <a id="2771" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2773" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="2783" class="Symbol">(</a><a id="2784" href="TypeChecker.html#281" class="Function">idToName</a> <a id="2793" href="TypeChecker.html#2746" class="Bound">x</a><a id="2794" class="Symbol">)</a>
      <a id="2802" href="TypeChecker.html#2802" class="Bound">e&#39;</a> <a id="2805" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2807" href="TypeChecker.html#2192" class="Function">checkExp</a> <a id="2816" href="TypeChecker.html#2748" class="Bound">e</a> <a id="2818" href="TypeChecker.html#2763" class="Bound">t</a>
      <a id="2826" href="Library.Monad.html#1110" class="Function">return</a> <a id="2833" class="Symbol">(</a><a id="2834" href="WellTypedSyntax.html#1186" class="InductiveConstructor">sAss</a> <a id="2839" href="TypeChecker.html#2767" class="Bound">x&#39;</a> <a id="2842" href="TypeChecker.html#2802" class="Bound">e&#39;</a><a id="2844" class="Symbol">)</a>

    <a id="2851" href="TypeChecker.html#2685" class="Function">checkStm</a> <a id="2860" class="Symbol">(</a><a id="2861" href="AST.html#1247" class="InductiveConstructor">A.sWhile</a> <a id="2870" href="TypeChecker.html#2870" class="Bound">e</a> <a id="2872" href="TypeChecker.html#2872" class="Bound">ss</a><a id="2874" class="Symbol">)</a> <a id="2876" class="Symbol">=</a> <a id="2878" class="Keyword">do</a>
      <a id="2887" href="TypeChecker.html#2887" class="Bound">e&#39;</a>  <a id="2891" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2893" href="TypeChecker.html#2192" class="Function">checkExp</a> <a id="2902" href="TypeChecker.html#2870" class="Bound">e</a> <a id="2904" href="AST.html#418" class="InductiveConstructor">bool</a>
      <a id="2915" href="TypeChecker.html#2915" class="Bound">ss&#39;</a> <a id="2919" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2921" href="TypeChecker.html#3007" class="Function">checkStms</a> <a id="2931" href="TypeChecker.html#2872" class="Bound">ss</a>
      <a id="2940" href="Library.Monad.html#1110" class="Function">return</a> <a id="2947" class="Symbol">(</a><a id="2948" href="WellTypedSyntax.html#1255" class="InductiveConstructor">sWhile</a> <a id="2955" href="TypeChecker.html#2887" class="Bound">e&#39;</a> <a id="2958" href="TypeChecker.html#2915" class="Bound">ss&#39;</a><a id="2961" class="Symbol">)</a>

    <a id="2968" class="Comment">-- Checking a list of statements.</a>

    <a id="CheckExpressions.checkStms"></a><a id="3007" href="TypeChecker.html#3007" class="Function">checkStms</a> <a id="3017" class="Symbol">:</a> <a id="3019" class="Symbol">(</a><a id="3020" href="TypeChecker.html#3020" class="Bound">ss</a> <a id="3023" class="Symbol">:</a> <a id="3025" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3030" href="AST.html#1181" class="Datatype">A.Stm</a><a id="3035" class="Symbol">)</a> <a id="3037" class="Symbol">→</a> <a id="3039" href="Library.Error.html#170" class="Function">Error</a> <a id="3045" class="Symbol">(</a><a id="3046" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="3051" href="TypeChecker.html#1365" class="Bound">Γ</a><a id="3052" class="Symbol">)</a>
    <a id="3058" href="TypeChecker.html#3007" class="Function">checkStms</a> <a id="3068" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="3077" class="Symbol">=</a> <a id="3079" href="Library.Monad.html#1110" class="Function">return</a> <a id="3086" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="3093" href="TypeChecker.html#3007" class="Function">checkStms</a> <a id="3103" class="Symbol">(</a><a id="3104" href="TypeChecker.html#3104" class="Bound">s</a> <a id="3106" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3108" href="TypeChecker.html#3108" class="Bound">ss</a><a id="3110" class="Symbol">)</a> <a id="3112" class="Symbol">=</a> <a id="3114" class="Keyword">do</a>
      <a id="3123" href="TypeChecker.html#3123" class="Bound">s&#39;</a> <a id="3126" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3128" href="TypeChecker.html#2685" class="Function">checkStm</a> <a id="3137" href="TypeChecker.html#3104" class="Bound">s</a>
      <a id="3145" class="Symbol">(</a><a id="3146" href="TypeChecker.html#3123" class="Bound">s&#39;</a> <a id="3149" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷_</a><a id="3151" class="Symbol">)</a> <a id="3153" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="3157" href="TypeChecker.html#3007" class="Function">checkStms</a> <a id="3167" href="TypeChecker.html#3108" class="Bound">ss</a>

<a id="3171" class="Comment">-- The declaration checker calls the expression checker.</a>
<a id="3228" class="Comment">-- Exported interface of expression checker:</a>

<a id="3274" class="Comment">-- Monad for checking expressions</a>

<a id="3309" class="Keyword">record</a> <a id="TCExp"></a><a id="3316" href="TypeChecker.html#3316" class="Record">TCExp</a> <a id="3322" href="TypeChecker.html#3322" class="Bound">Γ</a> <a id="3324" class="Symbol">(</a><a id="3325" href="TypeChecker.html#3325" class="Bound">A</a> <a id="3327" class="Symbol">:</a> <a id="3329" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3332" class="Symbol">)</a> <a id="3334" class="Symbol">:</a> <a id="3336" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3340" class="Keyword">where</a>
  <a id="3348" class="Keyword">field</a>
    <a id="TCExp.runTCExp"></a><a id="3358" href="TypeChecker.html#3358" class="Field">runTCExp</a> <a id="3367" class="Symbol">:</a> <a id="3369" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="3375" href="TypeChecker.html#3322" class="Bound">Γ</a> <a id="3377" class="Symbol">→</a> <a id="3379" href="Library.Error.html#170" class="Function">Error</a> <a id="3385" href="TypeChecker.html#3325" class="Bound">A</a>
<a id="3387" class="Keyword">open</a> <a id="3392" href="TypeChecker.html#3316" class="Module">TCExp</a>

<a id="checkExp"></a><a id="3399" href="TypeChecker.html#3399" class="Function">checkExp</a> <a id="3408" class="Symbol">:</a> <a id="3410" class="Symbol">∀{</a><a id="3412" href="TypeChecker.html#3412" class="Bound">Γ</a><a id="3413" class="Symbol">}</a> <a id="3415" class="Symbol">(</a><a id="3416" href="TypeChecker.html#3416" class="Bound">e</a> <a id="3418" class="Symbol">:</a> <a id="3420" href="AST.html#611" class="Datatype">A.Exp</a><a id="3425" class="Symbol">)</a> <a id="3427" class="Symbol">(</a><a id="3428" href="TypeChecker.html#3428" class="Bound">t</a> <a id="3430" class="Symbol">:</a> <a id="3432" href="AST.html#399" class="Datatype">Type</a><a id="3436" class="Symbol">)</a> <a id="3438" class="Symbol">→</a> <a id="3440" href="TypeChecker.html#3316" class="Record">TCExp</a> <a id="3446" href="TypeChecker.html#3412" class="Bound">Γ</a> <a id="3448" class="Symbol">(</a><a id="3449" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="3453" href="TypeChecker.html#3412" class="Bound">Γ</a> <a id="3455" href="TypeChecker.html#3428" class="Bound">t</a><a id="3456" class="Symbol">)</a>
<a id="3458" href="TypeChecker.html#3399" class="Function">checkExp</a> <a id="3467" href="TypeChecker.html#3467" class="Bound">e</a> <a id="3469" href="TypeChecker.html#3469" class="Bound">t</a> <a id="3471" class="Symbol">.</a><a id="3472" href="TypeChecker.html#3358" class="Field">runTCExp</a> <a id="3481" href="TypeChecker.html#3481" class="Bound">γ</a> <a id="3483" class="Symbol">=</a> <a id="3485" href="TypeChecker.html#2192" class="Function">CheckExpressions.checkExp</a> <a id="3511" href="TypeChecker.html#3481" class="Bound">γ</a> <a id="3513" href="TypeChecker.html#3467" class="Bound">e</a> <a id="3515" href="TypeChecker.html#3469" class="Bound">t</a>

<a id="checkStms"></a><a id="3518" href="TypeChecker.html#3518" class="Function">checkStms</a> <a id="3528" class="Symbol">:</a> <a id="3530" class="Symbol">∀{</a><a id="3532" href="TypeChecker.html#3532" class="Bound">Γ</a><a id="3533" class="Symbol">}</a> <a id="3535" class="Symbol">(</a><a id="3536" href="TypeChecker.html#3536" class="Bound">ss</a> <a id="3539" class="Symbol">:</a> <a id="3541" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3546" href="AST.html#1181" class="Datatype">A.Stm</a><a id="3551" class="Symbol">)</a> <a id="3553" class="Symbol">→</a> <a id="3555" href="TypeChecker.html#3316" class="Record">TCExp</a> <a id="3561" href="TypeChecker.html#3532" class="Bound">Γ</a> <a id="3563" class="Symbol">(</a><a id="3564" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="3569" href="TypeChecker.html#3532" class="Bound">Γ</a><a id="3570" class="Symbol">)</a>
<a id="3572" href="TypeChecker.html#3518" class="Function">checkStms</a> <a id="3582" href="TypeChecker.html#3582" class="Bound">ss</a> <a id="3585" class="Symbol">.</a><a id="3586" href="TypeChecker.html#3358" class="Field">runTCExp</a> <a id="3595" href="TypeChecker.html#3595" class="Bound">γ</a> <a id="3597" class="Symbol">=</a> <a id="3599" href="TypeChecker.html#3007" class="Function">CheckExpressions.checkStms</a> <a id="3626" href="TypeChecker.html#3595" class="Bound">γ</a> <a id="3628" href="TypeChecker.html#3582" class="Bound">ss</a>

<a id="3632" class="Comment">-- Checking declarations.</a>
<a id="3658" class="Comment">---------------------------------------------------------------------------</a>

<a id="3735" class="Comment">-- Monad for checking declarations.</a>

<a id="3772" class="Comment">-- Variable declarations can be inserted into the top block, thus,</a>
<a id="3839" class="Comment">-- we need to treat the top block as mutable state.</a>

<a id="3892" class="Keyword">record</a> <a id="TCDecl"></a><a id="3899" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="3906" href="TypeChecker.html#3906" class="Bound">Γ</a> <a id="3908" href="TypeChecker.html#3908" class="Bound">Γ&#39;</a> <a id="3911" class="Symbol">(</a><a id="3912" href="TypeChecker.html#3912" class="Bound">A</a> <a id="3914" class="Symbol">:</a> <a id="3916" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3919" class="Symbol">)</a> <a id="3921" class="Symbol">:</a> <a id="3923" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3927" class="Keyword">where</a>
  <a id="3935" class="Keyword">field</a>
    <a id="TCDecl.runTCDecl"></a><a id="3945" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="3955" class="Symbol">:</a> <a id="3957" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="3963" href="TypeChecker.html#3906" class="Bound">Γ</a> <a id="3965" class="Symbol">→</a> <a id="3967" href="Library.Error.html#170" class="Function">Error</a> <a id="3973" class="Symbol">(</a><a id="3974" href="TypeChecker.html#3912" class="Bound">A</a> <a id="3976" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3978" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="3984" href="TypeChecker.html#3908" class="Bound">Γ&#39;</a><a id="3986" class="Symbol">)</a>
<a id="3988" class="Keyword">open</a> <a id="3993" href="TypeChecker.html#3899" class="Module">TCDecl</a>

<a id="4001" class="Keyword">module</a> <a id="CheckDeclarations"></a><a id="4008" href="TypeChecker.html#4008" class="Module">CheckDeclarations</a> <a id="4026" class="Keyword">where</a>

  <a id="4035" class="Comment">-- TCDecl is a monad.</a>

  <a id="4060" class="Keyword">private</a>

    <a id="CheckDeclarations.returnTCDecl"></a><a id="4073" href="TypeChecker.html#4073" class="Function">returnTCDecl</a> <a id="4086" class="Symbol">:</a> <a id="4088" class="Symbol">∀</a> <a id="4090" class="Symbol">{</a><a id="4091" href="TypeChecker.html#4091" class="Bound">Γ</a> <a id="4093" href="TypeChecker.html#4093" class="Bound">A</a><a id="4094" class="Symbol">}</a> <a id="4096" class="Symbol">(</a><a id="4097" href="TypeChecker.html#4097" class="Bound">a</a> <a id="4099" class="Symbol">:</a> <a id="4101" href="TypeChecker.html#4093" class="Bound">A</a><a id="4102" class="Symbol">)</a> <a id="4104" class="Symbol">→</a> <a id="4106" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="4113" href="TypeChecker.html#4091" class="Bound">Γ</a> <a id="4115" href="TypeChecker.html#4091" class="Bound">Γ</a> <a id="4117" href="TypeChecker.html#4093" class="Bound">A</a>
    <a id="4123" href="TypeChecker.html#4073" class="Function">returnTCDecl</a> <a id="4136" href="TypeChecker.html#4136" class="Bound">a</a> <a id="4138" class="Symbol">.</a><a id="4139" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="4149" href="TypeChecker.html#4149" class="Bound">γ</a> <a id="4151" class="Symbol">=</a> <a id="4153" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4156" class="Symbol">(</a><a id="4157" href="TypeChecker.html#4136" class="Bound">a</a> <a id="4159" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4161" href="TypeChecker.html#4149" class="Bound">γ</a><a id="4162" class="Symbol">)</a>

    <a id="CheckDeclarations.bindTCDecl"></a><a id="4169" href="TypeChecker.html#4169" class="Function">bindTCDecl</a> <a id="4180" class="Symbol">:</a> <a id="4182" class="Symbol">∀{</a><a id="4184" href="TypeChecker.html#4184" class="Bound">Γ</a> <a id="4186" href="TypeChecker.html#4186" class="Bound">Γ′</a> <a id="4189" href="TypeChecker.html#4189" class="Bound">Γ″</a> <a id="4192" href="TypeChecker.html#4192" class="Bound">A</a> <a id="4194" href="TypeChecker.html#4194" class="Bound">B</a><a id="4195" class="Symbol">}</a>
      <a id="4203" class="Symbol">(</a><a id="4204" href="TypeChecker.html#4204" class="Bound">m</a> <a id="4206" class="Symbol">:</a>     <a id="4212" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="4219" href="TypeChecker.html#4184" class="Bound">Γ</a>  <a id="4222" href="TypeChecker.html#4186" class="Bound">Γ′</a> <a id="4225" href="TypeChecker.html#4192" class="Bound">A</a><a id="4226" class="Symbol">)</a>
      <a id="4234" class="Symbol">(</a><a id="4235" href="TypeChecker.html#4235" class="Bound">k</a> <a id="4237" class="Symbol">:</a> <a id="4239" href="TypeChecker.html#4192" class="Bound">A</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="4250" href="TypeChecker.html#4186" class="Bound">Γ′</a> <a id="4253" href="TypeChecker.html#4189" class="Bound">Γ″</a> <a id="4256" href="TypeChecker.html#4194" class="Bound">B</a><a id="4257" class="Symbol">)</a>
             <a id="4272" class="Symbol">→</a> <a id="4274" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="4281" href="TypeChecker.html#4184" class="Bound">Γ</a>  <a id="4284" href="TypeChecker.html#4189" class="Bound">Γ″</a> <a id="4287" href="TypeChecker.html#4194" class="Bound">B</a>

    <a id="4294" href="TypeChecker.html#4169" class="Function">bindTCDecl</a> <a id="4305" href="TypeChecker.html#4305" class="Bound">m</a> <a id="4307" href="TypeChecker.html#4307" class="Bound">k</a> <a id="4309" class="Symbol">.</a><a id="4310" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="4320" href="TypeChecker.html#4320" class="Bound">γ</a> <a id="4322" class="Symbol">=</a>
      <a id="4330" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4335" href="TypeChecker.html#4305" class="Bound">m</a> <a id="4337" class="Symbol">.</a><a id="4338" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="4348" href="TypeChecker.html#4320" class="Bound">γ</a> <a id="4350" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4353" class="Symbol">λ</a> <a id="4355" class="Keyword">where</a>
        <a id="4369" class="Symbol">(</a><a id="4370" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4375" href="TypeChecker.html#4375" class="Bound">err</a><a id="4378" class="Symbol">)</a>    <a id="4383" class="Symbol">→</a> <a id="4385" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4390" href="TypeChecker.html#4375" class="Bound">err</a>
        <a id="4402" class="Symbol">(</a><a id="4403" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4406" class="Symbol">(</a><a id="4407" href="TypeChecker.html#4407" class="Bound">a</a> <a id="4409" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4411" href="TypeChecker.html#4411" class="Bound">γ&#39;</a><a id="4413" class="Symbol">))</a> <a id="4416" class="Symbol">→</a> <a id="4418" href="TypeChecker.html#4307" class="Bound">k</a> <a id="4420" href="TypeChecker.html#4407" class="Bound">a</a> <a id="4422" class="Symbol">.</a><a id="4423" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="4433" href="TypeChecker.html#4411" class="Bound">γ&#39;</a>


  <a id="4440" class="Keyword">instance</a>
    <a id="CheckDeclarations.functorTCDecl"></a><a id="4453" href="TypeChecker.html#4453" class="Function">functorTCDecl</a> <a id="4467" class="Symbol">:</a> <a id="4469" class="Symbol">∀</a> <a id="4471" class="Symbol">{</a><a id="4472" href="TypeChecker.html#4472" class="Bound">Γ</a> <a id="4474" href="TypeChecker.html#4474" class="Bound">Γ′</a><a id="4476" class="Symbol">}</a> <a id="4478" class="Symbol">→</a> <a id="4480" href="Library.Monad.html#157" class="Record">Functor</a> <a id="4488" class="Symbol">(</a><a id="4489" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="4496" href="TypeChecker.html#4472" class="Bound">Γ</a> <a id="4498" href="TypeChecker.html#4474" class="Bound">Γ′</a><a id="4500" class="Symbol">)</a>
    <a id="4506" href="Library.Monad.html#245" class="Field">fmap</a> <a id="4511" class="Symbol">{{</a><a id="4513" href="TypeChecker.html#4453" class="Function">functorTCDecl</a><a id="4526" class="Symbol">}}</a> <a id="4529" href="TypeChecker.html#4529" class="Bound">f</a> <a id="4531" href="TypeChecker.html#4531" class="Bound">m</a> <a id="4533" class="Symbol">=</a> <a id="4535" href="TypeChecker.html#4169" class="Function">bindTCDecl</a> <a id="4546" href="TypeChecker.html#4531" class="Bound">m</a> <a id="4548" class="Symbol">(</a><a id="4549" href="TypeChecker.html#4073" class="Function">returnTCDecl</a> <a id="4562" href="Function.Base.html#3626" class="Function Operator">∘′</a> <a id="4565" href="TypeChecker.html#4529" class="Bound">f</a><a id="4566" class="Symbol">)</a>

    <a id="CheckDeclarations.iApplicativeTCDecl"></a><a id="4573" href="TypeChecker.html#4573" class="Function">iApplicativeTCDecl</a> <a id="4592" class="Symbol">:</a> <a id="4594" href="Library.Monad.html#368" class="Record">IApplicative</a> <a id="4607" href="TypeChecker.html#3899" class="Record">TCDecl</a>
    <a id="4618" href="Library.Monad.html#487" class="Field">pure</a>  <a id="4624" class="Symbol">{{</a><a id="4626" href="TypeChecker.html#4573" class="Function">iApplicativeTCDecl</a><a id="4644" class="Symbol">}}</a>       <a id="4653" class="Symbol">=</a> <a id="4655" href="TypeChecker.html#4073" class="Function">returnTCDecl</a>
    <a id="4672" href="Library.Monad.html#521" class="Field Operator">_&lt;*&gt;_</a> <a id="4678" class="Symbol">{{</a><a id="4680" href="TypeChecker.html#4573" class="Function">iApplicativeTCDecl</a><a id="4698" class="Symbol">}}</a> <a id="4701" href="TypeChecker.html#4701" class="Bound">mf</a> <a id="4704" href="TypeChecker.html#4704" class="Bound">mx</a> <a id="4707" class="Symbol">=</a> <a id="4709" href="TypeChecker.html#4169" class="Function">bindTCDecl</a> <a id="4720" href="TypeChecker.html#4701" class="Bound">mf</a> <a id="4723" class="Symbol">(</a><a id="4724" href="Library.Monad.html#284" class="Function Operator">_&lt;$&gt;</a> <a id="4729" href="TypeChecker.html#4704" class="Bound">mx</a><a id="4731" class="Symbol">)</a>

    <a id="CheckDeclarations.iMonadTCDecl"></a><a id="4738" href="TypeChecker.html#4738" class="Function">iMonadTCDecl</a> <a id="4751" class="Symbol">:</a> <a id="4753" href="Library.Monad.html#867" class="Record">IMonad</a> <a id="4760" href="TypeChecker.html#3899" class="Record">TCDecl</a>
    <a id="4771" href="Library.Monad.html#1002" class="Field Operator">_&gt;&gt;=_</a> <a id="4777" class="Symbol">{{</a><a id="4779" href="TypeChecker.html#4738" class="Function">iMonadTCDecl</a><a id="4791" class="Symbol">}}</a> <a id="4794" class="Symbol">=</a> <a id="4796" href="TypeChecker.html#4169" class="Function">bindTCDecl</a>

  <a id="4810" class="Comment">-- Lifting a TCExp computation into TCDecl.</a>

  <a id="CheckDeclarations.lift"></a><a id="4857" href="TypeChecker.html#4857" class="Function">lift</a> <a id="4862" class="Symbol">:</a> <a id="4864" class="Symbol">∀{</a><a id="4866" href="TypeChecker.html#4866" class="Bound">Γ</a> <a id="4868" href="TypeChecker.html#4868" class="Bound">A</a><a id="4869" class="Symbol">}</a> <a id="4871" class="Symbol">(</a><a id="4872" href="TypeChecker.html#4872" class="Bound">m</a> <a id="4874" class="Symbol">:</a> <a id="4876" href="TypeChecker.html#3316" class="Record">TCExp</a> <a id="4882" href="TypeChecker.html#4866" class="Bound">Γ</a> <a id="4884" href="TypeChecker.html#4868" class="Bound">A</a><a id="4885" class="Symbol">)</a> <a id="4887" class="Symbol">→</a> <a id="4889" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="4896" href="TypeChecker.html#4866" class="Bound">Γ</a> <a id="4898" href="TypeChecker.html#4866" class="Bound">Γ</a> <a id="4900" href="TypeChecker.html#4868" class="Bound">A</a>
  <a id="4904" href="TypeChecker.html#4857" class="Function">lift</a> <a id="4909" href="TypeChecker.html#4909" class="Bound">m</a> <a id="4911" class="Symbol">.</a><a id="4912" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="4922" href="TypeChecker.html#4922" class="Bound">γ</a> <a id="4924" class="Symbol">=</a>
    <a id="4930" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4935" href="TypeChecker.html#4909" class="Bound">m</a> <a id="4937" class="Symbol">.</a><a id="4938" href="TypeChecker.html#3358" class="Field">runTCExp</a> <a id="4947" href="TypeChecker.html#4922" class="Bound">γ</a> <a id="4949" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4952" class="Symbol">λ</a> <a id="4954" class="Keyword">where</a>
      <a id="4966" class="Symbol">(</a><a id="4967" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4972" href="TypeChecker.html#4972" class="Bound">err</a><a id="4975" class="Symbol">)</a> <a id="4977" class="Symbol">→</a> <a id="4979" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4984" href="TypeChecker.html#4972" class="Bound">err</a>
      <a id="4994" class="Symbol">(</a><a id="4995" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4998" href="TypeChecker.html#4998" class="Bound">a</a><a id="4999" class="Symbol">)</a>     <a id="5005" class="Symbol">→</a> <a id="5007" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5010" class="Symbol">(</a><a id="5011" href="TypeChecker.html#4998" class="Bound">a</a> <a id="5013" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5015" href="TypeChecker.html#4922" class="Bound">γ</a><a id="5016" class="Symbol">)</a>

  <a id="5021" class="Comment">-- Add a variable declaration.</a>

  <a id="CheckDeclarations.addVar"></a><a id="5055" href="TypeChecker.html#5055" class="Function">addVar</a> <a id="5062" class="Symbol">:</a> <a id="5064" class="Symbol">∀{</a><a id="5066" href="TypeChecker.html#5066" class="Bound">Γ</a><a id="5067" class="Symbol">}</a> <a id="5069" class="Symbol">(</a><a id="5070" href="TypeChecker.html#5070" class="Bound">x</a> <a id="5072" class="Symbol">:</a> <a id="5074" href="TypeChecker.html#266" class="Function">Name</a><a id="5078" class="Symbol">)</a> <a id="5080" href="TypeChecker.html#5080" class="Bound">t</a> <a id="5082" class="Symbol">→</a> <a id="5084" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="5091" href="TypeChecker.html#5066" class="Bound">Γ</a> <a id="5093" class="Symbol">(</a><a id="5094" href="TypeChecker.html#5080" class="Bound">t</a> <a id="5096" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5098" href="TypeChecker.html#5066" class="Bound">Γ</a><a id="5099" class="Symbol">)</a> <a id="5101" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="5105" href="TypeChecker.html#5055" class="Function">addVar</a> <a id="5112" class="Symbol">{</a><a id="5113" class="Argument">Γ</a> <a id="5115" class="Symbol">=</a> <a id="5117" href="TypeChecker.html#5117" class="Bound">Γ</a><a id="5118" class="Symbol">}</a> <a id="5120" href="TypeChecker.html#5120" class="Bound">x</a> <a id="5122" href="TypeChecker.html#5122" class="Bound">t</a> <a id="5124" class="Symbol">.</a><a id="5125" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="5135" href="TypeChecker.html#5135" class="Bound">γ</a> <a id="5137" class="Symbol">=</a> <a id="5139" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5142" class="Symbol">(_</a> <a id="5145" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5147" class="Symbol">(</a><a id="5148" href="TypeChecker.html#5122" class="Bound">t</a> <a id="5150" href="Library.List.html#1588" class="Function Operator">↦</a> <a id="5152" href="TypeChecker.html#5120" class="Bound">x</a> <a id="5154" href="Library.List.html#1588" class="Function Operator">∷</a> <a id="5156" href="TypeChecker.html#5135" class="Bound">γ</a><a id="5157" class="Symbol">))</a>

  <a id="5163" class="Comment">-- Predicting the next shape of the context.</a>

  <a id="CheckDeclarations.Next"></a><a id="5211" href="TypeChecker.html#5211" class="Function">Next</a> <a id="5216" class="Symbol">:</a> <a id="5218" class="Symbol">(</a><a id="5219" href="TypeChecker.html#5219" class="Bound">Γ</a> <a id="5221" class="Symbol">:</a> <a id="5223" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="5226" class="Symbol">)</a> <a id="5228" class="Symbol">(</a><a id="5229" href="TypeChecker.html#5229" class="Bound">s</a> <a id="5231" class="Symbol">:</a> <a id="5233" href="AST.html#1000" class="Record">A.Decl</a><a id="5239" class="Symbol">)</a> <a id="5241" class="Symbol">→</a> <a id="5243" href="WellTypedSyntax.html#279" class="Function">Cxt</a>
  <a id="5249" href="TypeChecker.html#5211" class="Function">Next</a> <a id="5254" href="TypeChecker.html#5254" class="Bound">Γ</a> <a id="5256" href="TypeChecker.html#5256" class="Bound">s</a> <a id="5258" class="Symbol">=</a> <a id="5260" href="AST.html#1045" class="Field">A.declType</a> <a id="5271" href="TypeChecker.html#5256" class="Bound">s</a> <a id="5273" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5275" href="TypeChecker.html#5254" class="Bound">Γ</a>

  <a id="CheckDeclarations.Nexts"></a><a id="5280" href="TypeChecker.html#5280" class="Function">Nexts</a> <a id="5286" class="Symbol">:</a> <a id="5288" class="Symbol">(</a><a id="5289" href="TypeChecker.html#5289" class="Bound">Γ</a> <a id="5291" class="Symbol">:</a> <a id="5293" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="5296" class="Symbol">)</a> <a id="5298" class="Symbol">(</a><a id="5299" href="TypeChecker.html#5299" class="Bound">ss</a> <a id="5302" class="Symbol">:</a> <a id="5304" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5309" href="AST.html#1000" class="Record">A.Decl</a><a id="5315" class="Symbol">)</a> <a id="5317" class="Symbol">→</a> <a id="5319" href="WellTypedSyntax.html#279" class="Function">Cxt</a>
  <a id="5325" href="TypeChecker.html#5280" class="Function">Nexts</a> <a id="5331" class="Symbol">=</a> <a id="5333" href="Data.List.Base.html#4249" class="Function">foldl</a> <a id="5339" href="TypeChecker.html#5211" class="Function">Next</a>

  <a id="5347" class="Keyword">mutual</a>

    <a id="5359" class="Comment">-- Checking a single declaration.</a>

    <a id="CheckDeclarations.checkDecl"></a><a id="5398" href="TypeChecker.html#5398" class="Function">checkDecl</a> <a id="5408" class="Symbol">:</a> <a id="5410" class="Symbol">∀</a> <a id="5412" class="Symbol">{</a><a id="5413" href="TypeChecker.html#5413" class="Bound">Γ</a><a id="5414" class="Symbol">}</a> <a id="5416" class="Symbol">(</a><a id="5417" href="TypeChecker.html#5417" class="Bound">d</a> <a id="5419" class="Symbol">:</a> <a id="5421" href="AST.html#1000" class="Record">A.Decl</a><a id="5427" class="Symbol">)</a> <a id="5429" class="Symbol">(</a><a id="5430" class="Keyword">let</a> <a id="5434" href="TypeChecker.html#5434" class="Bound">t</a> <a id="5436" class="Symbol">=</a> <a id="5438" href="AST.html#1045" class="Field">A.declType</a> <a id="5449" href="TypeChecker.html#5417" class="Bound">d</a><a id="5450" class="Symbol">)</a>
      <a id="5458" class="Symbol">→</a> <a id="5460" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="5467" href="TypeChecker.html#5413" class="Bound">Γ</a> <a id="5469" class="Symbol">(</a><a id="5470" href="TypeChecker.html#5434" class="Bound">t</a> <a id="5472" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5474" href="TypeChecker.html#5413" class="Bound">Γ</a><a id="5475" class="Symbol">)</a> <a id="5477" class="Symbol">(</a><a id="5478" href="WellTypedSyntax.html#914" class="Datatype">Decl</a> <a id="5483" href="TypeChecker.html#5413" class="Bound">Γ</a> <a id="5485" href="TypeChecker.html#5434" class="Bound">t</a><a id="5486" class="Symbol">)</a>

    <a id="5493" href="TypeChecker.html#5398" class="Function">checkDecl</a> <a id="5503" class="Symbol">(</a><a id="5504" href="AST.html#1031" class="InductiveConstructor">A.dInit</a> <a id="5512" href="TypeChecker.html#5512" class="Bound">t</a> <a id="5514" href="TypeChecker.html#5514" class="Bound">x</a> <a id="5516" href="TypeChecker.html#5516" class="Bound">e</a><a id="5517" class="Symbol">)</a> <a id="5519" class="Symbol">=</a> <a id="5521" class="Keyword">do</a>
      <a id="5530" href="TypeChecker.html#5530" class="Bound">e&#39;</a> <a id="5533" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="5535" href="TypeChecker.html#4857" class="Function">lift</a> <a id="5540" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5542" href="TypeChecker.html#3399" class="Function">checkExp</a> <a id="5551" href="TypeChecker.html#5516" class="Bound">e</a> <a id="5553" href="TypeChecker.html#5512" class="Bound">t</a>
      <a id="5561" href="TypeChecker.html#5055" class="Function">addVar</a> <a id="5568" class="Symbol">(</a><a id="5569" href="TypeChecker.html#281" class="Function">idToName</a> <a id="5578" href="TypeChecker.html#5514" class="Bound">x</a><a id="5579" class="Symbol">)</a> <a id="5581" href="TypeChecker.html#5512" class="Bound">t</a>
      <a id="5589" href="Library.Monad.html#1110" class="Function">return</a> <a id="5596" class="Symbol">(</a><a id="5597" href="WellTypedSyntax.html#954" class="InductiveConstructor">dInit</a> <a id="5603" href="TypeChecker.html#5530" class="Bound">e&#39;</a><a id="5605" class="Symbol">)</a>

    <a id="5612" class="Comment">-- Checking a list of declarations.</a>

    <a id="CheckDeclarations.checkDecls"></a><a id="5653" href="TypeChecker.html#5653" class="Function">checkDecls</a> <a id="5664" class="Symbol">:</a> <a id="5666" class="Symbol">∀</a> <a id="5668" class="Symbol">{</a><a id="5669" href="TypeChecker.html#5669" class="Bound">Γ</a><a id="5670" class="Symbol">}</a> <a id="5672" class="Symbol">(</a><a id="5673" href="TypeChecker.html#5673" class="Bound">ds</a> <a id="5676" class="Symbol">:</a> <a id="5678" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5683" href="AST.html#1000" class="Record">A.Decl</a><a id="5689" class="Symbol">)</a> <a id="5691" class="Symbol">(</a><a id="5692" class="Keyword">let</a> <a id="5696" href="TypeChecker.html#5696" class="Bound">Γ&#39;</a> <a id="5699" class="Symbol">=</a> <a id="5701" href="TypeChecker.html#5280" class="Function">Nexts</a> <a id="5707" href="TypeChecker.html#5669" class="Bound">Γ</a> <a id="5709" href="TypeChecker.html#5673" class="Bound">ds</a><a id="5711" class="Symbol">)</a>
      <a id="5719" class="Symbol">→</a> <a id="5721" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="5728" href="TypeChecker.html#5669" class="Bound">Γ</a> <a id="5730" href="TypeChecker.html#5696" class="Bound">Γ&#39;</a> <a id="5733" class="Symbol">(</a><a id="5734" href="WellTypedSyntax.html#993" class="Datatype">Decls</a> <a id="5740" href="TypeChecker.html#5669" class="Bound">Γ</a> <a id="5742" href="TypeChecker.html#5696" class="Bound">Γ&#39;</a><a id="5744" class="Symbol">)</a>

    <a id="5751" href="TypeChecker.html#5653" class="Function">checkDecls</a> <a id="5762" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="5771" class="Symbol">=</a> <a id="5773" href="Library.Monad.html#1110" class="Function">return</a> <a id="5780" href="WellTypedSyntax.html#1029" class="InductiveConstructor">[]</a>
    <a id="5787" href="TypeChecker.html#5653" class="Function">checkDecls</a> <a id="5798" class="Symbol">(</a><a id="5799" href="TypeChecker.html#5799" class="Bound">d</a> <a id="5801" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5803" href="TypeChecker.html#5803" class="Bound">ds</a><a id="5805" class="Symbol">)</a> <a id="5807" class="Symbol">=</a> <a id="5809" class="Keyword">do</a>
      <a id="5818" href="TypeChecker.html#5818" class="Bound">d&#39;</a> <a id="5821" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="5823" href="TypeChecker.html#5398" class="Function">checkDecl</a> <a id="5833" href="TypeChecker.html#5799" class="Bound">d</a>
      <a id="5841" class="Symbol">(</a><a id="5842" href="TypeChecker.html#5818" class="Bound">d&#39;</a> <a id="5845" href="WellTypedSyntax.html#1047" class="InductiveConstructor Operator">∷_</a><a id="5847" class="Symbol">)</a> <a id="5849" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="5853" href="TypeChecker.html#5653" class="Function">checkDecls</a> <a id="5864" href="TypeChecker.html#5803" class="Bound">ds</a>

  <a id="5870" class="Comment">-- Checking the program in TCDecl.</a>

  <a id="CheckDeclarations.checkProgram"></a><a id="5908" href="TypeChecker.html#5908" class="Function">checkProgram</a> <a id="5921" class="Symbol">:</a> <a id="5923" class="Symbol">(</a><a id="5924" href="TypeChecker.html#5924" class="Bound">prg</a> <a id="5928" class="Symbol">:</a> <a id="5930" href="AST.html#1361" class="Record">A.Program</a><a id="5939" class="Symbol">)</a> <a id="5941" class="Symbol">(</a><a id="5942" class="Keyword">let</a> <a id="5946" href="TypeChecker.html#5946" class="Bound">Γ</a> <a id="5948" class="Symbol">=</a> <a id="5950" href="TypeChecker.html#5280" class="Function">Nexts</a> <a id="5956" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5959" class="Symbol">(</a><a id="5960" href="AST.html#1415" class="Field">A.theDecls</a> <a id="5971" href="TypeChecker.html#5924" class="Bound">prg</a><a id="5974" class="Symbol">))</a>
    <a id="5981" class="Symbol">→</a> <a id="5983" href="TypeChecker.html#3899" class="Record">TCDecl</a> <a id="5990" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5993" href="TypeChecker.html#5946" class="Bound">Γ</a> <a id="5995" href="WellTypedSyntax.html#1503" class="Record">Program</a>

  <a id="6006" href="TypeChecker.html#5908" class="Function">checkProgram</a> <a id="6019" class="Symbol">(</a><a id="6020" href="AST.html#1395" class="InductiveConstructor">A.program</a> <a id="6030" href="TypeChecker.html#6030" class="Bound">ds</a> <a id="6033" href="TypeChecker.html#6033" class="Bound">ss</a> <a id="6036" href="TypeChecker.html#6036" class="Bound">e</a><a id="6037" class="Symbol">)</a> <a id="6039" class="Symbol">=</a> <a id="6041" class="Keyword">do</a>
    <a id="6048" href="TypeChecker.html#6048" class="Bound">ds&#39;</a> <a id="6052" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6054" href="TypeChecker.html#5653" class="Function">checkDecls</a> <a id="6065" href="TypeChecker.html#6030" class="Bound">ds</a>
    <a id="6072" href="TypeChecker.html#6072" class="Bound">ss&#39;</a> <a id="6076" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6078" href="TypeChecker.html#4857" class="Function">lift</a> <a id="6083" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6085" href="TypeChecker.html#3518" class="Function">checkStms</a> <a id="6095" href="TypeChecker.html#6033" class="Bound">ss</a>
    <a id="6102" href="TypeChecker.html#6102" class="Bound">e&#39;</a>  <a id="6106" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6108" href="TypeChecker.html#4857" class="Function">lift</a> <a id="6113" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6115" href="TypeChecker.html#3399" class="Function">checkExp</a> <a id="6124" href="TypeChecker.html#6036" class="Bound">e</a> <a id="6126" href="AST.html#423" class="InductiveConstructor">int</a>
    <a id="6134" href="Library.Monad.html#1110" class="Function">return</a> <a id="6141" class="Symbol">(</a><a id="6142" href="WellTypedSyntax.html#1537" class="InductiveConstructor">program</a> <a id="6150" href="TypeChecker.html#6048" class="Bound">ds&#39;</a> <a id="6154" href="TypeChecker.html#6072" class="Bound">ss&#39;</a> <a id="6158" href="TypeChecker.html#6102" class="Bound">e&#39;</a><a id="6160" class="Symbol">)</a>

<a id="6163" class="Comment">-- Checking the program.</a>
<a id="6188" class="Comment">---------------------------------------------------------------------------</a>

<a id="checkProgram"></a><a id="6265" href="TypeChecker.html#6265" class="Function">checkProgram</a> <a id="6278" class="Symbol">:</a> <a id="6280" class="Symbol">(</a><a id="6281" href="TypeChecker.html#6281" class="Bound">prg</a> <a id="6285" class="Symbol">:</a> <a id="6287" href="AST.html#1361" class="Record">A.Program</a><a id="6296" class="Symbol">)</a> <a id="6298" class="Symbol">→</a> <a id="6300" href="Library.Error.html#170" class="Function">Error</a> <a id="6306" href="WellTypedSyntax.html#1503" class="Record">Program</a>
<a id="6314" href="TypeChecker.html#6265" class="Function">checkProgram</a> <a id="6327" href="TypeChecker.html#6327" class="Bound">prg</a> <a id="6331" class="Symbol">=</a> <a id="6333" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="6339" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="6343" href="TypeChecker.html#5908" class="Function">CheckDeclarations.checkProgram</a> <a id="6374" href="TypeChecker.html#6327" class="Bound">prg</a> <a id="6378" class="Symbol">.</a><a id="6379" href="TypeChecker.html#3945" class="Field">runTCDecl</a> <a id="6389" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a>


<a id="6394" class="Comment">-- -}</a>
<a id="6400" class="Comment">-- -}</a>
<a id="6406" class="Comment">-- -}</a>
<a id="6412" class="Comment">-- -}</a>
<a id="6418" class="Comment">-- -}</a>
<a id="6424" class="Comment">-- -}</a>
</pre></body></html>