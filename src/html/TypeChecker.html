<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>TypeChecker</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Type checker for the WHILE language.</a>

<a id="42" class="Symbol">{-#</a> <a id="46" class="Keyword">OPTIONS</a> <a id="54" class="Pragma">--sized-types</a> <a id="68" class="Symbol">#-}</a>
<a id="72" class="Symbol">{-#</a> <a id="76" class="Keyword">OPTIONS</a> <a id="84" class="Pragma">--postfix-projections</a> <a id="106" class="Symbol">#-}</a>

<a id="111" class="Keyword">module</a> <a id="118" href="TypeChecker.html" class="Module">TypeChecker</a> <a id="130" class="Keyword">where</a>

<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Library.html" class="Module">Library</a>

<a id="158" class="Keyword">import</a> <a id="165" href="AST.html" class="Module">AST</a> <a id="169" class="Symbol">as</a> <a id="172" class="Module">A</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="WellTypedSyntax.html" class="Module">WellTypedSyntax</a>

<a id="203" class="Comment">-- Names as coming from the abstract syntax are just strings.</a>

<a id="Name"></a><a id="266" href="TypeChecker.html#266" class="Function">Name</a> <a id="271" class="Symbol">=</a> <a id="273" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="idToName"></a><a id="281" href="TypeChecker.html#281" class="Function">idToName</a> <a id="290" class="Symbol">:</a> <a id="292" href="AST.html#309" class="Datatype">A.Id</a> <a id="297" class="Symbol">→</a> <a id="299" href="TypeChecker.html#266" class="Function">Name</a>
<a id="304" href="TypeChecker.html#281" class="Function">idToName</a> <a id="313" class="Symbol">(</a><a id="314" href="AST.html#326" class="InductiveConstructor">A.mkId</a> <a id="321" href="TypeChecker.html#321" class="Bound">x</a><a id="322" class="Symbol">)</a> <a id="324" class="Symbol">=</a> <a id="326" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="342" href="TypeChecker.html#321" class="Bound">x</a>

<a id="345" class="Comment">-- Local context for the type checker.</a>

<a id="TCCxt"></a><a id="385" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="391" class="Symbol">:</a> <a id="393" class="Symbol">(</a><a id="394" href="TypeChecker.html#394" class="Bound">Γ</a> <a id="396" class="Symbol">:</a> <a id="398" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="401" class="Symbol">)</a> <a id="403" class="Symbol">→</a> <a id="405" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="409" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="415" href="TypeChecker.html#415" class="Bound">Γ</a> <a id="417" class="Symbol">=</a> <a id="419" href="Library.List.html#1386" class="Function">AssocList</a> <a id="429" href="TypeChecker.html#266" class="Function">Name</a> <a id="434" href="TypeChecker.html#415" class="Bound">Γ</a>

<a id="437" class="Comment">-- Querying the local context.</a>

<a id="469" class="Comment">-- Type errors.</a>
<a id="485" class="Comment">--</a>
<a id="488" class="Comment">-- Currently, these errors do not carry enough evidence that</a>
<a id="549" class="Comment">-- something is wrong.  The type checker does not produce</a>
<a id="607" class="Comment">-- evidence of ill-typedness in case of failure,</a>
<a id="656" class="Comment">-- only of well-typedness in case of success.</a>

<a id="703" class="Keyword">data</a> <a id="TypeError"></a><a id="708" href="TypeChecker.html#708" class="Datatype">TypeError</a> <a id="718" class="Symbol">:</a> <a id="720" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="724" class="Keyword">where</a>
  <a id="TypeError.unboundVariable"></a><a id="732" href="TypeChecker.html#732" class="InductiveConstructor">unboundVariable</a>        <a id="755" class="Symbol">:</a> <a id="757" href="TypeChecker.html#266" class="Function">Name</a> <a id="762" class="Symbol">→</a> <a id="764" href="TypeChecker.html#708" class="Datatype">TypeError</a>
  <a id="TypeError.typeMismatch"></a><a id="776" href="TypeChecker.html#776" class="InductiveConstructor">typeMismatch</a>           <a id="799" class="Symbol">:</a> <a id="801" class="Symbol">(</a><a id="802" href="TypeChecker.html#802" class="Bound">tinf</a> <a id="807" href="TypeChecker.html#807" class="Bound">texp</a> <a id="812" class="Symbol">:</a> <a id="814" href="AST.html#399" class="Datatype">Type</a><a id="818" class="Symbol">)</a>  <a id="821" class="Symbol">→</a> <a id="823" href="TypeChecker.html#802" class="Bound">tinf</a> <a id="828" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="830" href="TypeChecker.html#807" class="Bound">texp</a> <a id="835" class="Symbol">→</a> <a id="837" href="TypeChecker.html#708" class="Datatype">TypeError</a>

<a id="848" class="Keyword">instance</a>
  <a id="PrintError"></a><a id="859" href="TypeChecker.html#859" class="Function">PrintError</a> <a id="870" class="Symbol">:</a> <a id="872" href="Library.Print.html#196" class="Record">Print</a> <a id="878" href="TypeChecker.html#708" class="Datatype">TypeError</a>
  <a id="890" href="Library.Print.html#244" class="Field">print</a> <a id="896" class="Symbol">{{</a><a id="898" href="TypeChecker.html#859" class="Function">PrintError</a><a id="908" class="Symbol">}}</a> <a id="911" class="Symbol">=</a> <a id="913" class="Symbol">λ</a> <a id="915" class="Keyword">where</a>
    <a id="925" class="Symbol">(</a><a id="926" href="TypeChecker.html#732" class="InductiveConstructor">unboundVariable</a> <a id="942" href="TypeChecker.html#942" class="Bound">x</a><a id="943" class="Symbol">)</a>        <a id="952" class="Symbol">→</a> <a id="954" class="String">&quot;unbound variable &quot;</a> <a id="974" href="Data.String.Base.html#2425" class="Function Operator">String.++</a> <a id="984" href="TypeChecker.html#942" class="Bound">x</a>
    <a id="990" class="Symbol">(</a><a id="991" href="TypeChecker.html#776" class="InductiveConstructor">typeMismatch</a> <a id="1004" href="TypeChecker.html#1004" class="Bound">tinf</a> <a id="1009" href="TypeChecker.html#1009" class="Bound">texp</a> <a id="1014" class="Symbol">_)</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Data.String.Base.html#2613" class="Function">String.concat</a> <a id="1033" href="Function.Base.html#1974" class="Function Operator">$</a>
      <a id="1041" class="String">&quot;type mismatch: expected &quot;</a> <a id="1068" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1070" href="Library.Print.html#244" class="Field">print</a> <a id="1076" href="TypeChecker.html#1009" class="Bound">texp</a> <a id="1081" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
      <a id="1089" class="String">&quot;, but inferred &quot;</a> <a id="1107" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1109" href="Library.Print.html#244" class="Field">print</a> <a id="1115" href="TypeChecker.html#1004" class="Bound">tinf</a> <a id="1120" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1122" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="1126" class="Comment">-- Type error monad.</a>

<a id="1148" class="Keyword">open</a> <a id="1153" href="Library.Error.html#134" class="Module">ErrorMonad</a> <a id="1164" class="Symbol">{</a><a id="1165" class="Argument">E</a> <a id="1167" class="Symbol">=</a> <a id="1169" href="TypeChecker.html#708" class="Datatype">TypeError</a><a id="1178" class="Symbol">}</a>

<a id="1181" class="Comment">-- Checking expressions</a>
<a id="1205" class="Comment">---------------------------------------------------------------------------</a>

<a id="1282" class="Comment">-- During checking of expressions, the context is fixed.</a>

<a id="1340" class="Keyword">module</a> <a id="CheckExpressions"></a><a id="1347" href="TypeChecker.html#1347" class="Module">CheckExpressions</a> <a id="1364" class="Symbol">{</a><a id="1365" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="1367" class="Symbol">:</a> <a id="1369" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="1372" class="Symbol">}</a> <a id="1374" class="Symbol">(</a><a id="1375" href="TypeChecker.html#1375" class="Bound">γ</a> <a id="1377" class="Symbol">:</a> <a id="1379" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="1385" href="TypeChecker.html#1365" class="Bound">Γ</a><a id="1386" class="Symbol">)</a> <a id="1388" class="Keyword">where</a>

  <a id="1397" class="Comment">-- Environment.</a>

  <a id="CheckExpressions.lookupVar"></a><a id="1416" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="1426" class="Symbol">:</a> <a id="1428" class="Symbol">(</a><a id="1429" href="TypeChecker.html#1429" class="Bound">x</a> <a id="1431" class="Symbol">:</a> <a id="1433" href="TypeChecker.html#266" class="Function">Name</a><a id="1437" class="Symbol">)</a> <a id="1439" class="Symbol">→</a> <a id="1441" href="Library.Error.html#170" class="Function">Error</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="1450" class="Symbol">λ</a> <a id="1452" href="TypeChecker.html#1452" class="Bound">t</a> <a id="1454" class="Symbol">→</a> <a id="1456" href="WellTypedSyntax.html#296" class="Function">Var</a> <a id="1460" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="1462" href="TypeChecker.html#1452" class="Bound">t</a><a id="1463" class="Symbol">)</a>
  <a id="1467" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="1477" href="TypeChecker.html#1477" class="Bound">x</a> <a id="1479" class="Symbol">=</a>
    <a id="1485" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="1490" href="Library.List.html#1819" class="Function Operator">?↦</a> <a id="1493" href="TypeChecker.html#1477" class="Bound">x</a> <a id="1495" href="Library.List.html#1819" class="Function Operator">∈</a> <a id="1497" href="TypeChecker.html#1375" class="Bound">γ</a> <a id="1499" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="1502" class="Symbol">λ</a> <a id="1504" class="Keyword">where</a>
      <a id="1516" class="Symbol">(</a><a id="1517" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="1521" class="Symbol">(</a><a id="1522" href="TypeChecker.html#1522" class="Bound">t</a> <a id="1524" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1526" href="TypeChecker.html#1526" class="Bound">x&#39;</a> <a id="1529" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1531" class="Symbol">_))</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="Library.Monad.html#1110" class="Function">return</a> <a id="1544" class="Symbol">(</a><a id="1545" href="TypeChecker.html#1522" class="Bound">t</a> <a id="1547" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1549" href="TypeChecker.html#1526" class="Bound">x&#39;</a><a id="1551" class="Symbol">)</a>
      <a id="1559" class="Symbol">(</a><a id="1560" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1563" href="TypeChecker.html#1563" class="Bound">¬p</a><a id="1565" class="Symbol">)</a>            <a id="1578" class="Symbol">→</a> <a id="1580" href="Library.Error.html#912" class="Function">throwError</a> <a id="1591" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1593" href="TypeChecker.html#732" class="InductiveConstructor">unboundVariable</a> <a id="1609" href="TypeChecker.html#1477" class="Bound">x</a>

  <a id="1614" class="Comment">-- The expression checker.</a>

  <a id="1644" class="Keyword">mutual</a>

    <a id="1656" class="Comment">-- Type inference.</a>

    <a id="CheckExpressions.inferExp"></a><a id="1680" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1689" class="Symbol">:</a> <a id="1691" class="Symbol">(</a><a id="1692" href="TypeChecker.html#1692" class="Bound">e</a> <a id="1694" class="Symbol">:</a> <a id="1696" href="AST.html#611" class="Datatype">A.Exp</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Library.Error.html#170" class="Function">Error</a> <a id="1711" class="Symbol">(</a><a id="1712" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="1714" class="Symbol">λ</a> <a id="1716" class="Symbol">(</a><a id="1717" href="TypeChecker.html#1717" class="Bound">t</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="AST.html#399" class="Datatype">Type</a><a id="1725" class="Symbol">)</a> <a id="1727" class="Symbol">→</a> <a id="1729" href="WellTypedSyntax.html#636" class="Datatype">Exp</a> <a id="1733" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="1735" href="TypeChecker.html#1717" class="Bound">t</a><a id="1736" class="Symbol">)</a>

    <a id="1743" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1752" class="Symbol">(</a><a id="1753" href="AST.html#674" class="InductiveConstructor">A.eInt</a> <a id="1760" href="TypeChecker.html#1760" class="Bound">i</a><a id="1761" class="Symbol">)</a>  <a id="1764" class="Symbol">=</a> <a id="1766" href="Library.Monad.html#1110" class="Function">return</a> <a id="1773" class="Symbol">(</a><a id="1774" href="AST.html#423" class="InductiveConstructor">int</a>  <a id="1779" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1781" href="WellTypedSyntax.html#686" class="InductiveConstructor">eInt</a>  <a id="1787" href="TypeChecker.html#1760" class="Bound">i</a><a id="1788" class="Symbol">)</a>
    <a id="1794" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1803" class="Symbol">(</a><a id="1804" href="AST.html#719" class="InductiveConstructor">A.eBool</a> <a id="1812" href="TypeChecker.html#1812" class="Bound">b</a><a id="1813" class="Symbol">)</a> <a id="1815" class="Symbol">=</a> <a id="1817" href="Library.Monad.html#1110" class="Function">return</a> <a id="1824" class="Symbol">(</a><a id="1825" href="AST.html#418" class="InductiveConstructor">bool</a> <a id="1830" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1832" href="WellTypedSyntax.html#748" class="InductiveConstructor">eBool</a> <a id="1838" href="TypeChecker.html#1812" class="Bound">b</a><a id="1839" class="Symbol">)</a>

    <a id="1846" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1855" class="Symbol">(</a><a id="1856" href="AST.html#629" class="InductiveConstructor">A.eId</a> <a id="1862" href="TypeChecker.html#1862" class="Bound">x</a><a id="1863" class="Symbol">)</a> <a id="1865" class="Symbol">=</a> <a id="1867" class="Keyword">do</a>
      <a id="1876" class="Symbol">(</a><a id="1877" href="TypeChecker.html#1877" class="Bound">t</a> <a id="1879" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1881" href="TypeChecker.html#1881" class="Bound">x&#39;</a><a id="1883" class="Symbol">)</a> <a id="1885" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="1887" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="1897" class="Symbol">(</a><a id="1898" href="TypeChecker.html#281" class="Function">idToName</a> <a id="1907" href="TypeChecker.html#1862" class="Bound">x</a><a id="1908" class="Symbol">)</a>
      <a id="1916" href="Library.Monad.html#1110" class="Function">return</a> <a id="1923" class="Symbol">(</a><a id="1924" href="TypeChecker.html#1877" class="Bound">t</a> <a id="1926" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1928" href="WellTypedSyntax.html#904" class="InductiveConstructor">eVar</a> <a id="1933" href="TypeChecker.html#1881" class="Bound">x&#39;</a><a id="1935" class="Symbol">)</a>

    <a id="1942" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="1951" class="Symbol">(</a><a id="1952" href="AST.html#764" class="InductiveConstructor">A.ePlus</a>  <a id="1961" href="TypeChecker.html#1961" class="Bound">e₁</a> <a id="1964" href="TypeChecker.html#1964" class="Bound">e₂</a><a id="1966" class="Symbol">)</a> <a id="1968" class="Symbol">=</a> <a id="1970" href="TypeChecker.html#2534" class="Function">inferOp</a> <a id="1978" href="WellTypedSyntax.html#411" class="InductiveConstructor">plus</a>  <a id="1984" href="TypeChecker.html#1961" class="Bound">e₁</a> <a id="1987" href="TypeChecker.html#1964" class="Bound">e₂</a>

    <a id="1995" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2004" class="Symbol">(</a><a id="2005" href="AST.html#809" class="InductiveConstructor">A.eGt</a>    <a id="2014" href="TypeChecker.html#2014" class="Bound">e₁</a> <a id="2017" href="TypeChecker.html#2017" class="Bound">e₂</a><a id="2019" class="Symbol">)</a> <a id="2021" class="Symbol">=</a> <a id="2023" href="TypeChecker.html#2534" class="Function">inferOp</a> <a id="2031" href="WellTypedSyntax.html#433" class="InductiveConstructor">gt</a>    <a id="2037" href="TypeChecker.html#2014" class="Bound">e₁</a> <a id="2040" href="TypeChecker.html#2017" class="Bound">e₂</a>

    <a id="2048" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2057" class="Symbol">(</a><a id="2058" href="AST.html#854" class="InductiveConstructor">A.eAnd</a>   <a id="2067" href="TypeChecker.html#2067" class="Bound">e₁</a> <a id="2070" href="TypeChecker.html#2070" class="Bound">e₂</a><a id="2072" class="Symbol">)</a> <a id="2074" class="Symbol">=</a> <a id="2076" href="TypeChecker.html#2534" class="Function">inferOp</a> <a id="2084" href="WellTypedSyntax.html#456" class="InductiveConstructor">and</a>   <a id="2090" href="TypeChecker.html#2067" class="Bound">e₁</a> <a id="2093" href="TypeChecker.html#2070" class="Bound">e₂</a>

    <a id="2101" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2110" class="Symbol">(</a><a id="2111" href="AST.html#899" class="InductiveConstructor">A.eNeg</a> <a id="2118" href="TypeChecker.html#2118" class="Bound">e</a><a id="2119" class="Symbol">)</a>       <a id="2127" class="Symbol">=</a> <a id="2129" href="TypeChecker.html#2736" class="Function">inferuOp</a> <a id="2138" href="WellTypedSyntax.html#562" class="InductiveConstructor">neg</a> <a id="2142" href="TypeChecker.html#2118" class="Bound">e</a>

    <a id="2149" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2158" class="Symbol">(</a><a id="2159" href="AST.html#944" class="InductiveConstructor">A.eSub</a> <a id="2166" href="TypeChecker.html#2166" class="Bound">e₁</a> <a id="2169" href="TypeChecker.html#2169" class="Bound">e₂</a><a id="2171" class="Symbol">)</a>  <a id="2174" class="Symbol">=</a> <a id="2176" href="TypeChecker.html#2534" class="Function">inferOp</a> <a id="2184" href="WellTypedSyntax.html#479" class="InductiveConstructor">sub</a> <a id="2188" href="TypeChecker.html#2166" class="Bound">e₁</a> <a id="2191" href="TypeChecker.html#2169" class="Bound">e₂</a>

    <a id="2199" class="Comment">-- Type checking.</a>
    <a id="2221" class="Comment">-- Calls inference and checks inferred type against given type.</a>

    <a id="CheckExpressions.checkExp"></a><a id="2290" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="2299" class="Symbol">:</a> <a id="2301" class="Symbol">(</a><a id="2302" href="TypeChecker.html#2302" class="Bound">e</a> <a id="2304" class="Symbol">:</a> <a id="2306" href="AST.html#611" class="Datatype">A.Exp</a><a id="2311" class="Symbol">)</a> <a id="2313" class="Symbol">(</a><a id="2314" href="TypeChecker.html#2314" class="Bound">t</a> <a id="2316" class="Symbol">:</a> <a id="2318" href="AST.html#399" class="Datatype">Type</a><a id="2322" class="Symbol">)</a> <a id="2324" class="Symbol">→</a> <a id="2326" href="Library.Error.html#170" class="Function">Error</a> <a id="2332" class="Symbol">(</a><a id="2333" href="WellTypedSyntax.html#636" class="Datatype">Exp</a> <a id="2337" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="2339" href="TypeChecker.html#2314" class="Bound">t</a><a id="2340" class="Symbol">)</a>
    <a id="2346" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="2355" href="TypeChecker.html#2355" class="Bound">e</a> <a id="2357" href="TypeChecker.html#2357" class="Bound">t</a> <a id="2359" class="Symbol">=</a> <a id="2361" class="Keyword">do</a>
      <a id="2370" class="Symbol">(</a><a id="2371" href="TypeChecker.html#2371" class="Bound">t&#39;</a> <a id="2374" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2376" href="TypeChecker.html#2376" class="Bound">e&#39;</a><a id="2378" class="Symbol">)</a> <a id="2380" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2382" href="TypeChecker.html#1680" class="Function">inferExp</a> <a id="2391" href="TypeChecker.html#2355" class="Bound">e</a>
      <a id="2399" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="2404" href="TypeChecker.html#2371" class="Bound">t&#39;</a> <a id="2407" href="Library.Eq.html#681" class="Field Operator">≟</a> <a id="2409" href="TypeChecker.html#2357" class="Bound">t</a> <a id="2411" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="2414" class="Symbol">λ</a> <a id="2416" class="Keyword">where</a>
        <a id="2430" class="Symbol">(</a><a id="2431" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2435" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2439" class="Symbol">)</a> <a id="2441" class="Symbol">→</a> <a id="2443" href="Library.Monad.html#1110" class="Function">return</a> <a id="2450" href="TypeChecker.html#2376" class="Bound">e&#39;</a>
        <a id="2461" class="Symbol">(</a><a id="2462" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a>  <a id="2466" href="TypeChecker.html#2466" class="Bound">t&#39;≢t</a><a id="2470" class="Symbol">)</a> <a id="2472" class="Symbol">→</a> <a id="2474" href="Library.Error.html#912" class="Function">throwError</a> <a id="2485" class="Symbol">(</a><a id="2486" href="TypeChecker.html#776" class="InductiveConstructor">typeMismatch</a> <a id="2499" href="TypeChecker.html#2371" class="Bound">t&#39;</a> <a id="2502" href="TypeChecker.html#2357" class="Bound">t</a> <a id="2504" href="TypeChecker.html#2466" class="Bound">t&#39;≢t</a><a id="2508" class="Symbol">)</a>

    <a id="2515" class="Comment">-- Operators.</a>

    <a id="CheckExpressions.inferOp"></a><a id="2534" href="TypeChecker.html#2534" class="Function">inferOp</a> <a id="2542" class="Symbol">:</a> <a id="2544" class="Symbol">∀{</a><a id="2546" href="TypeChecker.html#2546" class="Bound">t</a> <a id="2548" href="TypeChecker.html#2548" class="Bound">t&#39;</a><a id="2550" class="Symbol">}</a> <a id="2552" class="Symbol">(</a><a id="2553" href="TypeChecker.html#2553" class="Bound">op</a> <a id="2556" class="Symbol">:</a> <a id="2558" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="2561" href="TypeChecker.html#2546" class="Bound">t</a> <a id="2563" href="TypeChecker.html#2548" class="Bound">t&#39;</a><a id="2565" class="Symbol">)</a> <a id="2567" class="Symbol">(</a><a id="2568" href="TypeChecker.html#2568" class="Bound">e₁</a> <a id="2571" href="TypeChecker.html#2571" class="Bound">e₂</a> <a id="2574" class="Symbol">:</a> <a id="2576" href="AST.html#611" class="Datatype">A.Exp</a><a id="2581" class="Symbol">)</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="Library.Error.html#170" class="Function">Error</a> <a id="2591" class="Symbol">(</a><a id="2592" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="2594" class="Symbol">λ</a> <a id="2596" href="TypeChecker.html#2596" class="Bound">t</a> <a id="2598" class="Symbol">→</a> <a id="2600" href="WellTypedSyntax.html#636" class="Datatype">Exp</a> <a id="2604" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="2606" href="TypeChecker.html#2596" class="Bound">t</a><a id="2607" class="Symbol">)</a>
    <a id="2613" href="TypeChecker.html#2534" class="Function">inferOp</a> <a id="2621" class="Symbol">{</a><a id="2622" href="TypeChecker.html#2622" class="Bound">t</a><a id="2623" class="Symbol">}</a> <a id="2625" class="Symbol">{</a><a id="2626" href="TypeChecker.html#2626" class="Bound">t&#39;</a><a id="2628" class="Symbol">}</a> <a id="2630" href="TypeChecker.html#2630" class="Bound">op</a> <a id="2633" href="TypeChecker.html#2633" class="Bound">e₁</a> <a id="2636" href="TypeChecker.html#2636" class="Bound">e₂</a> <a id="2639" class="Symbol">=</a> <a id="2641" class="Keyword">do</a>
      <a id="2650" href="TypeChecker.html#2650" class="Bound">e₁&#39;</a> <a id="2654" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2656" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="2665" href="TypeChecker.html#2633" class="Bound">e₁</a> <a id="2668" href="TypeChecker.html#2622" class="Bound">t</a>
      <a id="2676" href="TypeChecker.html#2676" class="Bound">e₂&#39;</a> <a id="2680" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2682" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="2691" href="TypeChecker.html#2636" class="Bound">e₂</a> <a id="2694" href="TypeChecker.html#2622" class="Bound">t</a>
      <a id="2702" href="Library.Monad.html#1110" class="Function">return</a> <a id="2709" class="Symbol">(</a><a id="2710" href="TypeChecker.html#2626" class="Bound">t&#39;</a> <a id="2713" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2715" href="WellTypedSyntax.html#827" class="InductiveConstructor">eOp</a> <a id="2719" href="TypeChecker.html#2630" class="Bound">op</a> <a id="2722" href="TypeChecker.html#2650" class="Bound">e₁&#39;</a> <a id="2726" href="TypeChecker.html#2676" class="Bound">e₂&#39;</a><a id="2729" class="Symbol">)</a>

    <a id="CheckExpressions.inferuOp"></a><a id="2736" href="TypeChecker.html#2736" class="Function">inferuOp</a> <a id="2745" class="Symbol">:</a> <a id="2747" class="Symbol">∀{</a><a id="2749" href="TypeChecker.html#2749" class="Bound">t</a> <a id="2751" href="TypeChecker.html#2751" class="Bound">t&#39;</a><a id="2753" class="Symbol">}</a> <a id="2755" class="Symbol">(</a><a id="2756" href="TypeChecker.html#2756" class="Bound">uop</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="WellTypedSyntax.html#523" class="Datatype">uOp</a> <a id="2766" href="TypeChecker.html#2749" class="Bound">t</a> <a id="2768" href="TypeChecker.html#2751" class="Bound">t&#39;</a><a id="2770" class="Symbol">)</a> <a id="2772" class="Symbol">(</a><a id="2773" href="TypeChecker.html#2773" class="Bound">e</a> <a id="2775" class="Symbol">:</a> <a id="2777" href="AST.html#611" class="Datatype">A.Exp</a><a id="2782" class="Symbol">)</a> <a id="2784" class="Symbol">→</a> <a id="2786" href="Library.Error.html#170" class="Function">Error</a> <a id="2792" class="Symbol">(</a><a id="2793" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="2795" class="Symbol">λ</a> <a id="2797" href="TypeChecker.html#2797" class="Bound">t</a> <a id="2799" class="Symbol">→</a> <a id="2801" href="WellTypedSyntax.html#636" class="Datatype">Exp</a> <a id="2805" href="TypeChecker.html#1365" class="Bound">Γ</a> <a id="2807" href="TypeChecker.html#2797" class="Bound">t</a><a id="2808" class="Symbol">)</a>
    <a id="2814" href="TypeChecker.html#2736" class="Function">inferuOp</a> <a id="2823" class="Symbol">{</a><a id="2824" href="TypeChecker.html#2824" class="Bound">t</a><a id="2825" class="Symbol">}</a> <a id="2827" class="Symbol">{</a><a id="2828" href="TypeChecker.html#2828" class="Bound">t&#39;</a><a id="2830" class="Symbol">}</a> <a id="2832" href="TypeChecker.html#2832" class="Bound">uop</a> <a id="2836" href="TypeChecker.html#2836" class="Bound">e</a> <a id="2838" class="Symbol">=</a> <a id="2840" class="Keyword">do</a>
      <a id="2849" href="TypeChecker.html#2849" class="Bound">e&#39;</a> <a id="2852" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="2854" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="2863" href="TypeChecker.html#2836" class="Bound">e</a> <a id="2865" href="TypeChecker.html#2824" class="Bound">t</a>
      <a id="2873" href="Library.Monad.html#1110" class="Function">return</a> <a id="2880" class="Symbol">(</a> <a id="2882" href="TypeChecker.html#2828" class="Bound">t&#39;</a> <a id="2885" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2887" href="WellTypedSyntax.html#964" class="InductiveConstructor">euOp</a> <a id="2892" href="TypeChecker.html#2832" class="Bound">uop</a> <a id="2896" href="TypeChecker.html#2849" class="Bound">e&#39;</a> <a id="2899" class="Symbol">)</a>

  <a id="2904" class="Keyword">mutual</a>

    <a id="2916" class="Comment">-- Checking a single statement.</a>

    <a id="CheckExpressions.checkStm"></a><a id="2953" href="TypeChecker.html#2953" class="Function">checkStm</a> <a id="2962" class="Symbol">:</a> <a id="2964" class="Symbol">(</a><a id="2965" href="TypeChecker.html#2965" class="Bound">s</a> <a id="2967" class="Symbol">:</a> <a id="2969" href="AST.html#1289" class="Datatype">A.Stm</a><a id="2974" class="Symbol">)</a> <a id="2976" class="Symbol">→</a> <a id="2978" href="Library.Error.html#170" class="Function">Error</a> <a id="2984" class="Symbol">(</a><a id="2985" href="WellTypedSyntax.html#1323" class="Datatype">Stm</a> <a id="2989" href="TypeChecker.html#1365" class="Bound">Γ</a><a id="2990" class="Symbol">)</a>

    <a id="2997" href="TypeChecker.html#2953" class="Function">checkStm</a> <a id="3006" class="Symbol">(</a><a id="3007" href="AST.html#1307" class="InductiveConstructor">A.sAss</a> <a id="3014" href="TypeChecker.html#3014" class="Bound">x</a> <a id="3016" href="TypeChecker.html#3016" class="Bound">e</a><a id="3017" class="Symbol">)</a> <a id="3019" class="Symbol">=</a> <a id="3021" class="Keyword">do</a>
      <a id="3030" class="Symbol">(</a><a id="3031" href="TypeChecker.html#3031" class="Bound">t</a> <a id="3033" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3035" href="TypeChecker.html#3035" class="Bound">x&#39;</a><a id="3037" class="Symbol">)</a> <a id="3039" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3041" href="TypeChecker.html#1416" class="Function">lookupVar</a> <a id="3051" class="Symbol">(</a><a id="3052" href="TypeChecker.html#281" class="Function">idToName</a> <a id="3061" href="TypeChecker.html#3014" class="Bound">x</a><a id="3062" class="Symbol">)</a>
      <a id="3070" href="TypeChecker.html#3070" class="Bound">e&#39;</a> <a id="3073" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3075" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="3084" href="TypeChecker.html#3016" class="Bound">e</a> <a id="3086" href="TypeChecker.html#3031" class="Bound">t</a>
      <a id="3094" href="Library.Monad.html#1110" class="Function">return</a> <a id="3101" class="Symbol">(</a><a id="3102" href="WellTypedSyntax.html#1353" class="InductiveConstructor">sAss</a> <a id="3107" href="TypeChecker.html#3035" class="Bound">x&#39;</a> <a id="3110" href="TypeChecker.html#3070" class="Bound">e&#39;</a><a id="3112" class="Symbol">)</a>

    <a id="3119" href="TypeChecker.html#2953" class="Function">checkStm</a> <a id="3128" class="Symbol">(</a><a id="3129" href="AST.html#1355" class="InductiveConstructor">A.sWhile</a> <a id="3138" href="TypeChecker.html#3138" class="Bound">e</a> <a id="3140" href="TypeChecker.html#3140" class="Bound">ss</a><a id="3142" class="Symbol">)</a> <a id="3144" class="Symbol">=</a> <a id="3146" class="Keyword">do</a>
      <a id="3155" href="TypeChecker.html#3155" class="Bound">e&#39;</a>  <a id="3159" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3161" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="3170" href="TypeChecker.html#3138" class="Bound">e</a> <a id="3172" href="AST.html#418" class="InductiveConstructor">bool</a>
      <a id="3183" href="TypeChecker.html#3183" class="Bound">ss&#39;</a> <a id="3187" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3189" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3199" href="TypeChecker.html#3140" class="Bound">ss</a>
      <a id="3208" href="Library.Monad.html#1110" class="Function">return</a> <a id="3215" class="Symbol">(</a><a id="3216" href="WellTypedSyntax.html#1422" class="InductiveConstructor">sWhile</a> <a id="3223" href="TypeChecker.html#3155" class="Bound">e&#39;</a> <a id="3226" href="TypeChecker.html#3183" class="Bound">ss&#39;</a><a id="3229" class="Symbol">)</a>

    <a id="3236" href="TypeChecker.html#2953" class="Function">checkStm</a> <a id="3245" class="Symbol">(</a><a id="3246" href="AST.html#1403" class="InductiveConstructor">A.sIfElse</a> <a id="3256" href="TypeChecker.html#3256" class="Bound">i</a> <a id="3258" href="TypeChecker.html#3258" class="Bound">ss₁</a> <a id="3262" href="TypeChecker.html#3262" class="Bound">ss₂</a><a id="3265" class="Symbol">)</a> <a id="3267" class="Symbol">=</a> <a id="3269" class="Keyword">do</a>
      <a id="3278" href="TypeChecker.html#3278" class="Bound">i&#39;</a> <a id="3281" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3283" href="TypeChecker.html#2290" class="Function">checkExp</a> <a id="3292" href="TypeChecker.html#3256" class="Bound">i</a> <a id="3294" href="AST.html#418" class="InductiveConstructor">bool</a>
      <a id="3305" href="TypeChecker.html#3305" class="Bound">ss₁&#39;</a> <a id="3310" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3312" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3322" href="TypeChecker.html#3258" class="Bound">ss₁</a>
      <a id="3332" href="TypeChecker.html#3332" class="Bound">ss₂&#39;</a> <a id="3337" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3339" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3349" href="TypeChecker.html#3262" class="Bound">ss₂</a>
      <a id="3359" href="Library.Monad.html#1110" class="Function">return</a> <a id="3366" class="Symbol">(</a><a id="3367" href="WellTypedSyntax.html#1491" class="InductiveConstructor">sIfElse</a> <a id="3375" href="TypeChecker.html#3278" class="Bound">i&#39;</a> <a id="3378" href="TypeChecker.html#3305" class="Bound">ss₁&#39;</a> <a id="3383" href="TypeChecker.html#3332" class="Bound">ss₂&#39;</a><a id="3387" class="Symbol">)</a>

    <a id="3394" class="Comment">-- Checking a list of statements.</a>

    <a id="CheckExpressions.checkStms"></a><a id="3433" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3443" class="Symbol">:</a> <a id="3445" class="Symbol">(</a><a id="3446" href="TypeChecker.html#3446" class="Bound">ss</a> <a id="3449" class="Symbol">:</a> <a id="3451" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3456" href="AST.html#1289" class="Datatype">A.Stm</a><a id="3461" class="Symbol">)</a> <a id="3463" class="Symbol">→</a> <a id="3465" href="Library.Error.html#170" class="Function">Error</a> <a id="3471" class="Symbol">(</a><a id="3472" href="WellTypedSyntax.html#1559" class="Function">Stms</a> <a id="3477" href="TypeChecker.html#1365" class="Bound">Γ</a><a id="3478" class="Symbol">)</a>
    <a id="3484" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3494" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="3503" class="Symbol">=</a> <a id="3505" href="Library.Monad.html#1110" class="Function">return</a> <a id="3512" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="3519" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3529" class="Symbol">(</a><a id="3530" href="TypeChecker.html#3530" class="Bound">s</a> <a id="3532" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3534" href="TypeChecker.html#3534" class="Bound">ss</a><a id="3536" class="Symbol">)</a> <a id="3538" class="Symbol">=</a> <a id="3540" class="Keyword">do</a>
      <a id="3549" href="TypeChecker.html#3549" class="Bound">s&#39;</a> <a id="3552" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="3554" href="TypeChecker.html#2953" class="Function">checkStm</a> <a id="3563" href="TypeChecker.html#3530" class="Bound">s</a>
      <a id="3571" class="Symbol">(</a><a id="3572" href="TypeChecker.html#3549" class="Bound">s&#39;</a> <a id="3575" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷_</a><a id="3577" class="Symbol">)</a> <a id="3579" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="3583" href="TypeChecker.html#3433" class="Function">checkStms</a> <a id="3593" href="TypeChecker.html#3534" class="Bound">ss</a>

<a id="3597" class="Comment">-- The declaration checker calls the expression checker.</a>
<a id="3654" class="Comment">-- Exported interface of expression checker:</a>

<a id="3700" class="Comment">-- Monad for checking expressions</a>

<a id="3735" class="Keyword">record</a> <a id="TCExp"></a><a id="3742" href="TypeChecker.html#3742" class="Record">TCExp</a> <a id="3748" href="TypeChecker.html#3748" class="Bound">Γ</a> <a id="3750" class="Symbol">(</a><a id="3751" href="TypeChecker.html#3751" class="Bound">A</a> <a id="3753" class="Symbol">:</a> <a id="3755" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3758" class="Symbol">)</a> <a id="3760" class="Symbol">:</a> <a id="3762" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3766" class="Keyword">where</a>
  <a id="3774" class="Keyword">field</a>
    <a id="TCExp.runTCExp"></a><a id="3784" href="TypeChecker.html#3784" class="Field">runTCExp</a> <a id="3793" class="Symbol">:</a> <a id="3795" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="3801" href="TypeChecker.html#3748" class="Bound">Γ</a> <a id="3803" class="Symbol">→</a> <a id="3805" href="Library.Error.html#170" class="Function">Error</a> <a id="3811" href="TypeChecker.html#3751" class="Bound">A</a>
<a id="3813" class="Keyword">open</a> <a id="3818" href="TypeChecker.html#3742" class="Module">TCExp</a>

<a id="checkExp"></a><a id="3825" href="TypeChecker.html#3825" class="Function">checkExp</a> <a id="3834" class="Symbol">:</a> <a id="3836" class="Symbol">∀{</a><a id="3838" href="TypeChecker.html#3838" class="Bound">Γ</a><a id="3839" class="Symbol">}</a> <a id="3841" class="Symbol">(</a><a id="3842" href="TypeChecker.html#3842" class="Bound">e</a> <a id="3844" class="Symbol">:</a> <a id="3846" href="AST.html#611" class="Datatype">A.Exp</a><a id="3851" class="Symbol">)</a> <a id="3853" class="Symbol">(</a><a id="3854" href="TypeChecker.html#3854" class="Bound">t</a> <a id="3856" class="Symbol">:</a> <a id="3858" href="AST.html#399" class="Datatype">Type</a><a id="3862" class="Symbol">)</a> <a id="3864" class="Symbol">→</a> <a id="3866" href="TypeChecker.html#3742" class="Record">TCExp</a> <a id="3872" href="TypeChecker.html#3838" class="Bound">Γ</a> <a id="3874" class="Symbol">(</a><a id="3875" href="WellTypedSyntax.html#636" class="Datatype">Exp</a> <a id="3879" href="TypeChecker.html#3838" class="Bound">Γ</a> <a id="3881" href="TypeChecker.html#3854" class="Bound">t</a><a id="3882" class="Symbol">)</a>
<a id="3884" href="TypeChecker.html#3825" class="Function">checkExp</a> <a id="3893" href="TypeChecker.html#3893" class="Bound">e</a> <a id="3895" href="TypeChecker.html#3895" class="Bound">t</a> <a id="3897" class="Symbol">.</a><a id="3898" href="TypeChecker.html#3784" class="Field">runTCExp</a> <a id="3907" href="TypeChecker.html#3907" class="Bound">γ</a> <a id="3909" class="Symbol">=</a> <a id="3911" href="TypeChecker.html#2290" class="Function">CheckExpressions.checkExp</a> <a id="3937" href="TypeChecker.html#3907" class="Bound">γ</a> <a id="3939" href="TypeChecker.html#3893" class="Bound">e</a> <a id="3941" href="TypeChecker.html#3895" class="Bound">t</a>

<a id="checkStms"></a><a id="3944" href="TypeChecker.html#3944" class="Function">checkStms</a> <a id="3954" class="Symbol">:</a> <a id="3956" class="Symbol">∀{</a><a id="3958" href="TypeChecker.html#3958" class="Bound">Γ</a><a id="3959" class="Symbol">}</a> <a id="3961" class="Symbol">(</a><a id="3962" href="TypeChecker.html#3962" class="Bound">ss</a> <a id="3965" class="Symbol">:</a> <a id="3967" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3972" href="AST.html#1289" class="Datatype">A.Stm</a><a id="3977" class="Symbol">)</a> <a id="3979" class="Symbol">→</a> <a id="3981" href="TypeChecker.html#3742" class="Record">TCExp</a> <a id="3987" href="TypeChecker.html#3958" class="Bound">Γ</a> <a id="3989" class="Symbol">(</a><a id="3990" href="WellTypedSyntax.html#1559" class="Function">Stms</a> <a id="3995" href="TypeChecker.html#3958" class="Bound">Γ</a><a id="3996" class="Symbol">)</a>
<a id="3998" href="TypeChecker.html#3944" class="Function">checkStms</a> <a id="4008" href="TypeChecker.html#4008" class="Bound">ss</a> <a id="4011" class="Symbol">.</a><a id="4012" href="TypeChecker.html#3784" class="Field">runTCExp</a> <a id="4021" href="TypeChecker.html#4021" class="Bound">γ</a> <a id="4023" class="Symbol">=</a> <a id="4025" href="TypeChecker.html#3433" class="Function">CheckExpressions.checkStms</a> <a id="4052" href="TypeChecker.html#4021" class="Bound">γ</a> <a id="4054" href="TypeChecker.html#4008" class="Bound">ss</a>

<a id="4058" class="Comment">-- Checking declarations.</a>
<a id="4084" class="Comment">---------------------------------------------------------------------------</a>

<a id="4161" class="Comment">-- Monad for checking declarations.</a>

<a id="4198" class="Comment">-- Variable declarations can be inserted into the top block, thus,</a>
<a id="4265" class="Comment">-- we need to treat the top block as mutable state.</a>

<a id="4318" class="Keyword">record</a> <a id="TCDecl"></a><a id="4325" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="4332" href="TypeChecker.html#4332" class="Bound">Γ</a> <a id="4334" href="TypeChecker.html#4334" class="Bound">Γ&#39;</a> <a id="4337" class="Symbol">(</a><a id="4338" href="TypeChecker.html#4338" class="Bound">A</a> <a id="4340" class="Symbol">:</a> <a id="4342" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4345" class="Symbol">)</a> <a id="4347" class="Symbol">:</a> <a id="4349" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="4353" class="Keyword">where</a>
  <a id="4361" class="Keyword">field</a>
    <a id="TCDecl.runTCDecl"></a><a id="4371" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="4381" class="Symbol">:</a> <a id="4383" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="4389" href="TypeChecker.html#4332" class="Bound">Γ</a> <a id="4391" class="Symbol">→</a> <a id="4393" href="Library.Error.html#170" class="Function">Error</a> <a id="4399" class="Symbol">(</a><a id="4400" href="TypeChecker.html#4338" class="Bound">A</a> <a id="4402" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4404" href="TypeChecker.html#385" class="Function">TCCxt</a> <a id="4410" href="TypeChecker.html#4334" class="Bound">Γ&#39;</a><a id="4412" class="Symbol">)</a>
<a id="4414" class="Keyword">open</a> <a id="4419" href="TypeChecker.html#4325" class="Module">TCDecl</a>

<a id="4427" class="Keyword">module</a> <a id="CheckDeclarations"></a><a id="4434" href="TypeChecker.html#4434" class="Module">CheckDeclarations</a> <a id="4452" class="Keyword">where</a>

  <a id="4461" class="Comment">-- TCDecl is a monad.</a>

  <a id="4486" class="Keyword">private</a>

    <a id="CheckDeclarations.returnTCDecl"></a><a id="4499" href="TypeChecker.html#4499" class="Function">returnTCDecl</a> <a id="4512" class="Symbol">:</a> <a id="4514" class="Symbol">∀</a> <a id="4516" class="Symbol">{</a><a id="4517" href="TypeChecker.html#4517" class="Bound">Γ</a> <a id="4519" href="TypeChecker.html#4519" class="Bound">A</a><a id="4520" class="Symbol">}</a> <a id="4522" class="Symbol">(</a><a id="4523" href="TypeChecker.html#4523" class="Bound">a</a> <a id="4525" class="Symbol">:</a> <a id="4527" href="TypeChecker.html#4519" class="Bound">A</a><a id="4528" class="Symbol">)</a> <a id="4530" class="Symbol">→</a> <a id="4532" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="4539" href="TypeChecker.html#4517" class="Bound">Γ</a> <a id="4541" href="TypeChecker.html#4517" class="Bound">Γ</a> <a id="4543" href="TypeChecker.html#4519" class="Bound">A</a>
    <a id="4549" href="TypeChecker.html#4499" class="Function">returnTCDecl</a> <a id="4562" href="TypeChecker.html#4562" class="Bound">a</a> <a id="4564" class="Symbol">.</a><a id="4565" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="4575" href="TypeChecker.html#4575" class="Bound">γ</a> <a id="4577" class="Symbol">=</a> <a id="4579" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4582" class="Symbol">(</a><a id="4583" href="TypeChecker.html#4562" class="Bound">a</a> <a id="4585" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4587" href="TypeChecker.html#4575" class="Bound">γ</a><a id="4588" class="Symbol">)</a>

    <a id="CheckDeclarations.bindTCDecl"></a><a id="4595" href="TypeChecker.html#4595" class="Function">bindTCDecl</a> <a id="4606" class="Symbol">:</a> <a id="4608" class="Symbol">∀{</a><a id="4610" href="TypeChecker.html#4610" class="Bound">Γ</a> <a id="4612" href="TypeChecker.html#4612" class="Bound">Γ′</a> <a id="4615" href="TypeChecker.html#4615" class="Bound">Γ″</a> <a id="4618" href="TypeChecker.html#4618" class="Bound">A</a> <a id="4620" href="TypeChecker.html#4620" class="Bound">B</a><a id="4621" class="Symbol">}</a>
      <a id="4629" class="Symbol">(</a><a id="4630" href="TypeChecker.html#4630" class="Bound">m</a> <a id="4632" class="Symbol">:</a>     <a id="4638" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="4645" href="TypeChecker.html#4610" class="Bound">Γ</a>  <a id="4648" href="TypeChecker.html#4612" class="Bound">Γ′</a> <a id="4651" href="TypeChecker.html#4618" class="Bound">A</a><a id="4652" class="Symbol">)</a>
      <a id="4660" class="Symbol">(</a><a id="4661" href="TypeChecker.html#4661" class="Bound">k</a> <a id="4663" class="Symbol">:</a> <a id="4665" href="TypeChecker.html#4618" class="Bound">A</a> <a id="4667" class="Symbol">→</a> <a id="4669" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="4676" href="TypeChecker.html#4612" class="Bound">Γ′</a> <a id="4679" href="TypeChecker.html#4615" class="Bound">Γ″</a> <a id="4682" href="TypeChecker.html#4620" class="Bound">B</a><a id="4683" class="Symbol">)</a>
             <a id="4698" class="Symbol">→</a> <a id="4700" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="4707" href="TypeChecker.html#4610" class="Bound">Γ</a>  <a id="4710" href="TypeChecker.html#4615" class="Bound">Γ″</a> <a id="4713" href="TypeChecker.html#4620" class="Bound">B</a>

    <a id="4720" href="TypeChecker.html#4595" class="Function">bindTCDecl</a> <a id="4731" href="TypeChecker.html#4731" class="Bound">m</a> <a id="4733" href="TypeChecker.html#4733" class="Bound">k</a> <a id="4735" class="Symbol">.</a><a id="4736" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="4746" href="TypeChecker.html#4746" class="Bound">γ</a> <a id="4748" class="Symbol">=</a>
      <a id="4756" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4761" href="TypeChecker.html#4731" class="Bound">m</a> <a id="4763" class="Symbol">.</a><a id="4764" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="4774" href="TypeChecker.html#4746" class="Bound">γ</a> <a id="4776" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4779" class="Symbol">λ</a> <a id="4781" class="Keyword">where</a>
        <a id="4795" class="Symbol">(</a><a id="4796" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4801" href="TypeChecker.html#4801" class="Bound">err</a><a id="4804" class="Symbol">)</a>    <a id="4809" class="Symbol">→</a> <a id="4811" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="4816" href="TypeChecker.html#4801" class="Bound">err</a>
        <a id="4828" class="Symbol">(</a><a id="4829" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="4832" class="Symbol">(</a><a id="4833" href="TypeChecker.html#4833" class="Bound">a</a> <a id="4835" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4837" href="TypeChecker.html#4837" class="Bound">γ&#39;</a><a id="4839" class="Symbol">))</a> <a id="4842" class="Symbol">→</a> <a id="4844" href="TypeChecker.html#4733" class="Bound">k</a> <a id="4846" href="TypeChecker.html#4833" class="Bound">a</a> <a id="4848" class="Symbol">.</a><a id="4849" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="4859" href="TypeChecker.html#4837" class="Bound">γ&#39;</a>


  <a id="4866" class="Keyword">instance</a>
    <a id="CheckDeclarations.functorTCDecl"></a><a id="4879" href="TypeChecker.html#4879" class="Function">functorTCDecl</a> <a id="4893" class="Symbol">:</a> <a id="4895" class="Symbol">∀</a> <a id="4897" class="Symbol">{</a><a id="4898" href="TypeChecker.html#4898" class="Bound">Γ</a> <a id="4900" href="TypeChecker.html#4900" class="Bound">Γ′</a><a id="4902" class="Symbol">}</a> <a id="4904" class="Symbol">→</a> <a id="4906" href="Library.Monad.html#157" class="Record">Functor</a> <a id="4914" class="Symbol">(</a><a id="4915" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="4922" href="TypeChecker.html#4898" class="Bound">Γ</a> <a id="4924" href="TypeChecker.html#4900" class="Bound">Γ′</a><a id="4926" class="Symbol">)</a>
    <a id="4932" href="Library.Monad.html#245" class="Field">fmap</a> <a id="4937" class="Symbol">{{</a><a id="4939" href="TypeChecker.html#4879" class="Function">functorTCDecl</a><a id="4952" class="Symbol">}}</a> <a id="4955" href="TypeChecker.html#4955" class="Bound">f</a> <a id="4957" href="TypeChecker.html#4957" class="Bound">m</a> <a id="4959" class="Symbol">=</a> <a id="4961" href="TypeChecker.html#4595" class="Function">bindTCDecl</a> <a id="4972" href="TypeChecker.html#4957" class="Bound">m</a> <a id="4974" class="Symbol">(</a><a id="4975" href="TypeChecker.html#4499" class="Function">returnTCDecl</a> <a id="4988" href="Function.Base.html#3626" class="Function Operator">∘′</a> <a id="4991" href="TypeChecker.html#4955" class="Bound">f</a><a id="4992" class="Symbol">)</a>

    <a id="CheckDeclarations.iApplicativeTCDecl"></a><a id="4999" href="TypeChecker.html#4999" class="Function">iApplicativeTCDecl</a> <a id="5018" class="Symbol">:</a> <a id="5020" href="Library.Monad.html#368" class="Record">IApplicative</a> <a id="5033" href="TypeChecker.html#4325" class="Record">TCDecl</a>
    <a id="5044" href="Library.Monad.html#487" class="Field">pure</a>  <a id="5050" class="Symbol">{{</a><a id="5052" href="TypeChecker.html#4999" class="Function">iApplicativeTCDecl</a><a id="5070" class="Symbol">}}</a>       <a id="5079" class="Symbol">=</a> <a id="5081" href="TypeChecker.html#4499" class="Function">returnTCDecl</a>
    <a id="5098" href="Library.Monad.html#521" class="Field Operator">_&lt;*&gt;_</a> <a id="5104" class="Symbol">{{</a><a id="5106" href="TypeChecker.html#4999" class="Function">iApplicativeTCDecl</a><a id="5124" class="Symbol">}}</a> <a id="5127" href="TypeChecker.html#5127" class="Bound">mf</a> <a id="5130" href="TypeChecker.html#5130" class="Bound">mx</a> <a id="5133" class="Symbol">=</a> <a id="5135" href="TypeChecker.html#4595" class="Function">bindTCDecl</a> <a id="5146" href="TypeChecker.html#5127" class="Bound">mf</a> <a id="5149" class="Symbol">(</a><a id="5150" href="Library.Monad.html#284" class="Function Operator">_&lt;$&gt;</a> <a id="5155" href="TypeChecker.html#5130" class="Bound">mx</a><a id="5157" class="Symbol">)</a>

    <a id="CheckDeclarations.iMonadTCDecl"></a><a id="5164" href="TypeChecker.html#5164" class="Function">iMonadTCDecl</a> <a id="5177" class="Symbol">:</a> <a id="5179" href="Library.Monad.html#867" class="Record">IMonad</a> <a id="5186" href="TypeChecker.html#4325" class="Record">TCDecl</a>
    <a id="5197" href="Library.Monad.html#1002" class="Field Operator">_&gt;&gt;=_</a> <a id="5203" class="Symbol">{{</a><a id="5205" href="TypeChecker.html#5164" class="Function">iMonadTCDecl</a><a id="5217" class="Symbol">}}</a> <a id="5220" class="Symbol">=</a> <a id="5222" href="TypeChecker.html#4595" class="Function">bindTCDecl</a>

  <a id="5236" class="Comment">-- Lifting a TCExp computation into TCDecl.</a>

  <a id="CheckDeclarations.lift"></a><a id="5283" href="TypeChecker.html#5283" class="Function">lift</a> <a id="5288" class="Symbol">:</a> <a id="5290" class="Symbol">∀{</a><a id="5292" href="TypeChecker.html#5292" class="Bound">Γ</a> <a id="5294" href="TypeChecker.html#5294" class="Bound">A</a><a id="5295" class="Symbol">}</a> <a id="5297" class="Symbol">(</a><a id="5298" href="TypeChecker.html#5298" class="Bound">m</a> <a id="5300" class="Symbol">:</a> <a id="5302" href="TypeChecker.html#3742" class="Record">TCExp</a> <a id="5308" href="TypeChecker.html#5292" class="Bound">Γ</a> <a id="5310" href="TypeChecker.html#5294" class="Bound">A</a><a id="5311" class="Symbol">)</a> <a id="5313" class="Symbol">→</a> <a id="5315" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="5322" href="TypeChecker.html#5292" class="Bound">Γ</a> <a id="5324" href="TypeChecker.html#5292" class="Bound">Γ</a> <a id="5326" href="TypeChecker.html#5294" class="Bound">A</a>
  <a id="5330" href="TypeChecker.html#5283" class="Function">lift</a> <a id="5335" href="TypeChecker.html#5335" class="Bound">m</a> <a id="5337" class="Symbol">.</a><a id="5338" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="5348" href="TypeChecker.html#5348" class="Bound">γ</a> <a id="5350" class="Symbol">=</a>
    <a id="5356" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5361" href="TypeChecker.html#5335" class="Bound">m</a> <a id="5363" class="Symbol">.</a><a id="5364" href="TypeChecker.html#3784" class="Field">runTCExp</a> <a id="5373" href="TypeChecker.html#5348" class="Bound">γ</a> <a id="5375" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="5378" class="Symbol">λ</a> <a id="5380" class="Keyword">where</a>
      <a id="5392" class="Symbol">(</a><a id="5393" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="5398" href="TypeChecker.html#5398" class="Bound">err</a><a id="5401" class="Symbol">)</a> <a id="5403" class="Symbol">→</a> <a id="5405" href="Library.Error.html#238" class="InductiveConstructor">fail</a> <a id="5410" href="TypeChecker.html#5398" class="Bound">err</a>
      <a id="5420" class="Symbol">(</a><a id="5421" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5424" href="TypeChecker.html#5424" class="Bound">a</a><a id="5425" class="Symbol">)</a>     <a id="5431" class="Symbol">→</a> <a id="5433" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5436" class="Symbol">(</a><a id="5437" href="TypeChecker.html#5424" class="Bound">a</a> <a id="5439" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5441" href="TypeChecker.html#5348" class="Bound">γ</a><a id="5442" class="Symbol">)</a>

  <a id="5447" class="Comment">-- Add a variable declaration.</a>

  <a id="CheckDeclarations.addVar"></a><a id="5481" href="TypeChecker.html#5481" class="Function">addVar</a> <a id="5488" class="Symbol">:</a> <a id="5490" class="Symbol">∀{</a><a id="5492" href="TypeChecker.html#5492" class="Bound">Γ</a><a id="5493" class="Symbol">}</a> <a id="5495" class="Symbol">(</a><a id="5496" href="TypeChecker.html#5496" class="Bound">x</a> <a id="5498" class="Symbol">:</a> <a id="5500" href="TypeChecker.html#266" class="Function">Name</a><a id="5504" class="Symbol">)</a> <a id="5506" href="TypeChecker.html#5506" class="Bound">t</a> <a id="5508" class="Symbol">→</a> <a id="5510" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="5517" href="TypeChecker.html#5492" class="Bound">Γ</a> <a id="5519" class="Symbol">(</a><a id="5520" href="TypeChecker.html#5506" class="Bound">t</a> <a id="5522" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5524" href="TypeChecker.html#5492" class="Bound">Γ</a><a id="5525" class="Symbol">)</a> <a id="5527" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="5531" href="TypeChecker.html#5481" class="Function">addVar</a> <a id="5538" class="Symbol">{</a><a id="5539" class="Argument">Γ</a> <a id="5541" class="Symbol">=</a> <a id="5543" href="TypeChecker.html#5543" class="Bound">Γ</a><a id="5544" class="Symbol">}</a> <a id="5546" href="TypeChecker.html#5546" class="Bound">x</a> <a id="5548" href="TypeChecker.html#5548" class="Bound">t</a> <a id="5550" class="Symbol">.</a><a id="5551" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="5561" href="TypeChecker.html#5561" class="Bound">γ</a> <a id="5563" class="Symbol">=</a> <a id="5565" href="Library.Error.html#268" class="InductiveConstructor">ok</a> <a id="5568" class="Symbol">(_</a> <a id="5571" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5573" class="Symbol">(</a><a id="5574" href="TypeChecker.html#5548" class="Bound">t</a> <a id="5576" href="Library.List.html#1588" class="Function Operator">↦</a> <a id="5578" href="TypeChecker.html#5546" class="Bound">x</a> <a id="5580" href="Library.List.html#1588" class="Function Operator">∷</a> <a id="5582" href="TypeChecker.html#5561" class="Bound">γ</a><a id="5583" class="Symbol">))</a>

  <a id="5589" class="Comment">-- Predicting the next shape of the context.</a>

  <a id="CheckDeclarations.Next"></a><a id="5637" href="TypeChecker.html#5637" class="Function">Next</a> <a id="5642" class="Symbol">:</a> <a id="5644" class="Symbol">(</a><a id="5645" href="TypeChecker.html#5645" class="Bound">Γ</a> <a id="5647" class="Symbol">:</a> <a id="5649" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="5652" class="Symbol">)</a> <a id="5654" class="Symbol">(</a><a id="5655" href="TypeChecker.html#5655" class="Bound">s</a> <a id="5657" class="Symbol">:</a> <a id="5659" href="AST.html#1108" class="Record">A.Decl</a><a id="5665" class="Symbol">)</a> <a id="5667" class="Symbol">→</a> <a id="5669" href="WellTypedSyntax.html#279" class="Function">Cxt</a>
  <a id="5675" href="TypeChecker.html#5637" class="Function">Next</a> <a id="5680" href="TypeChecker.html#5680" class="Bound">Γ</a> <a id="5682" href="TypeChecker.html#5682" class="Bound">s</a> <a id="5684" class="Symbol">=</a> <a id="5686" href="AST.html#1153" class="Field">A.declType</a> <a id="5697" href="TypeChecker.html#5682" class="Bound">s</a> <a id="5699" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5701" href="TypeChecker.html#5680" class="Bound">Γ</a>

  <a id="CheckDeclarations.Nexts"></a><a id="5706" href="TypeChecker.html#5706" class="Function">Nexts</a> <a id="5712" class="Symbol">:</a> <a id="5714" class="Symbol">(</a><a id="5715" href="TypeChecker.html#5715" class="Bound">Γ</a> <a id="5717" class="Symbol">:</a> <a id="5719" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="5722" class="Symbol">)</a> <a id="5724" class="Symbol">(</a><a id="5725" href="TypeChecker.html#5725" class="Bound">ss</a> <a id="5728" class="Symbol">:</a> <a id="5730" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5735" href="AST.html#1108" class="Record">A.Decl</a><a id="5741" class="Symbol">)</a> <a id="5743" class="Symbol">→</a> <a id="5745" href="WellTypedSyntax.html#279" class="Function">Cxt</a>
  <a id="5751" href="TypeChecker.html#5706" class="Function">Nexts</a> <a id="5757" class="Symbol">=</a> <a id="5759" href="Data.List.Base.html#4249" class="Function">foldl</a> <a id="5765" href="TypeChecker.html#5637" class="Function">Next</a>

  <a id="5773" class="Keyword">mutual</a>

    <a id="5785" class="Comment">-- Checking a single declaration.</a>

    <a id="CheckDeclarations.checkDecl"></a><a id="5824" href="TypeChecker.html#5824" class="Function">checkDecl</a> <a id="5834" class="Symbol">:</a> <a id="5836" class="Symbol">∀</a> <a id="5838" class="Symbol">{</a><a id="5839" href="TypeChecker.html#5839" class="Bound">Γ</a><a id="5840" class="Symbol">}</a> <a id="5842" class="Symbol">(</a><a id="5843" href="TypeChecker.html#5843" class="Bound">d</a> <a id="5845" class="Symbol">:</a> <a id="5847" href="AST.html#1108" class="Record">A.Decl</a><a id="5853" class="Symbol">)</a> <a id="5855" class="Symbol">(</a><a id="5856" class="Keyword">let</a> <a id="5860" href="TypeChecker.html#5860" class="Bound">t</a> <a id="5862" class="Symbol">=</a> <a id="5864" href="AST.html#1153" class="Field">A.declType</a> <a id="5875" href="TypeChecker.html#5843" class="Bound">d</a><a id="5876" class="Symbol">)</a>
      <a id="5884" class="Symbol">→</a> <a id="5886" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="5893" href="TypeChecker.html#5839" class="Bound">Γ</a> <a id="5895" class="Symbol">(</a><a id="5896" href="TypeChecker.html#5860" class="Bound">t</a> <a id="5898" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5900" href="TypeChecker.html#5839" class="Bound">Γ</a><a id="5901" class="Symbol">)</a> <a id="5903" class="Symbol">(</a><a id="5904" href="WellTypedSyntax.html#1081" class="Datatype">Decl</a> <a id="5909" href="TypeChecker.html#5839" class="Bound">Γ</a> <a id="5911" href="TypeChecker.html#5860" class="Bound">t</a><a id="5912" class="Symbol">)</a>

    <a id="5919" href="TypeChecker.html#5824" class="Function">checkDecl</a> <a id="5929" class="Symbol">(</a><a id="5930" href="AST.html#1139" class="InductiveConstructor">A.dInit</a> <a id="5938" href="TypeChecker.html#5938" class="Bound">t</a> <a id="5940" href="TypeChecker.html#5940" class="Bound">x</a> <a id="5942" href="TypeChecker.html#5942" class="Bound">e</a><a id="5943" class="Symbol">)</a> <a id="5945" class="Symbol">=</a> <a id="5947" class="Keyword">do</a>
      <a id="5956" href="TypeChecker.html#5956" class="Bound">e&#39;</a> <a id="5959" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="5961" href="TypeChecker.html#5283" class="Function">lift</a> <a id="5966" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5968" href="TypeChecker.html#3825" class="Function">checkExp</a> <a id="5977" href="TypeChecker.html#5942" class="Bound">e</a> <a id="5979" href="TypeChecker.html#5938" class="Bound">t</a>
      <a id="5987" href="TypeChecker.html#5481" class="Function">addVar</a> <a id="5994" class="Symbol">(</a><a id="5995" href="TypeChecker.html#281" class="Function">idToName</a> <a id="6004" href="TypeChecker.html#5940" class="Bound">x</a><a id="6005" class="Symbol">)</a> <a id="6007" href="TypeChecker.html#5938" class="Bound">t</a>
      <a id="6015" href="Library.Monad.html#1110" class="Function">return</a> <a id="6022" class="Symbol">(</a><a id="6023" href="WellTypedSyntax.html#1121" class="InductiveConstructor">dInit</a> <a id="6029" href="TypeChecker.html#5956" class="Bound">e&#39;</a><a id="6031" class="Symbol">)</a>

    <a id="6038" class="Comment">-- Checking a list of declarations.</a>

    <a id="CheckDeclarations.checkDecls"></a><a id="6079" href="TypeChecker.html#6079" class="Function">checkDecls</a> <a id="6090" class="Symbol">:</a> <a id="6092" class="Symbol">∀</a> <a id="6094" class="Symbol">{</a><a id="6095" href="TypeChecker.html#6095" class="Bound">Γ</a><a id="6096" class="Symbol">}</a> <a id="6098" class="Symbol">(</a><a id="6099" href="TypeChecker.html#6099" class="Bound">ds</a> <a id="6102" class="Symbol">:</a> <a id="6104" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6109" href="AST.html#1108" class="Record">A.Decl</a><a id="6115" class="Symbol">)</a> <a id="6117" class="Symbol">(</a><a id="6118" class="Keyword">let</a> <a id="6122" href="TypeChecker.html#6122" class="Bound">Γ&#39;</a> <a id="6125" class="Symbol">=</a> <a id="6127" href="TypeChecker.html#5706" class="Function">Nexts</a> <a id="6133" href="TypeChecker.html#6095" class="Bound">Γ</a> <a id="6135" href="TypeChecker.html#6099" class="Bound">ds</a><a id="6137" class="Symbol">)</a>
      <a id="6145" class="Symbol">→</a> <a id="6147" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="6154" href="TypeChecker.html#6095" class="Bound">Γ</a> <a id="6156" href="TypeChecker.html#6122" class="Bound">Γ&#39;</a> <a id="6159" class="Symbol">(</a><a id="6160" href="WellTypedSyntax.html#1160" class="Datatype">Decls</a> <a id="6166" href="TypeChecker.html#6095" class="Bound">Γ</a> <a id="6168" href="TypeChecker.html#6122" class="Bound">Γ&#39;</a><a id="6170" class="Symbol">)</a>

    <a id="6177" href="TypeChecker.html#6079" class="Function">checkDecls</a> <a id="6188" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="6197" class="Symbol">=</a> <a id="6199" href="Library.Monad.html#1110" class="Function">return</a> <a id="6206" href="WellTypedSyntax.html#1196" class="InductiveConstructor">[]</a>
    <a id="6213" href="TypeChecker.html#6079" class="Function">checkDecls</a> <a id="6224" class="Symbol">(</a><a id="6225" href="TypeChecker.html#6225" class="Bound">d</a> <a id="6227" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6229" href="TypeChecker.html#6229" class="Bound">ds</a><a id="6231" class="Symbol">)</a> <a id="6233" class="Symbol">=</a> <a id="6235" class="Keyword">do</a>
      <a id="6244" href="TypeChecker.html#6244" class="Bound">d&#39;</a> <a id="6247" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6249" href="TypeChecker.html#5824" class="Function">checkDecl</a> <a id="6259" href="TypeChecker.html#6225" class="Bound">d</a>
      <a id="6267" class="Symbol">(</a><a id="6268" href="TypeChecker.html#6244" class="Bound">d&#39;</a> <a id="6271" href="WellTypedSyntax.html#1214" class="InductiveConstructor Operator">∷_</a><a id="6273" class="Symbol">)</a> <a id="6275" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="6279" href="TypeChecker.html#6079" class="Function">checkDecls</a> <a id="6290" href="TypeChecker.html#6229" class="Bound">ds</a>

  <a id="6296" class="Comment">-- Checking the program in TCDecl.</a>

  <a id="CheckDeclarations.checkProgram"></a><a id="6334" href="TypeChecker.html#6334" class="Function">checkProgram</a> <a id="6347" class="Symbol">:</a> <a id="6349" class="Symbol">(</a><a id="6350" href="TypeChecker.html#6350" class="Bound">prg</a> <a id="6354" class="Symbol">:</a> <a id="6356" href="AST.html#1530" class="Record">A.Program</a><a id="6365" class="Symbol">)</a> <a id="6367" class="Symbol">(</a><a id="6368" class="Keyword">let</a> <a id="6372" href="TypeChecker.html#6372" class="Bound">Γ</a> <a id="6374" class="Symbol">=</a> <a id="6376" href="TypeChecker.html#5706" class="Function">Nexts</a> <a id="6382" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6385" class="Symbol">(</a><a id="6386" href="AST.html#1584" class="Field">A.theDecls</a> <a id="6397" href="TypeChecker.html#6350" class="Bound">prg</a><a id="6400" class="Symbol">))</a>
    <a id="6407" class="Symbol">→</a> <a id="6409" href="TypeChecker.html#4325" class="Record">TCDecl</a> <a id="6416" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6419" href="TypeChecker.html#6372" class="Bound">Γ</a> <a id="6421" href="WellTypedSyntax.html#1670" class="Record">Program</a>

  <a id="6432" href="TypeChecker.html#6334" class="Function">checkProgram</a> <a id="6445" class="Symbol">(</a><a id="6446" href="AST.html#1564" class="InductiveConstructor">A.program</a> <a id="6456" href="TypeChecker.html#6456" class="Bound">ds</a> <a id="6459" href="TypeChecker.html#6459" class="Bound">ss</a> <a id="6462" href="TypeChecker.html#6462" class="Bound">e</a><a id="6463" class="Symbol">)</a> <a id="6465" class="Symbol">=</a> <a id="6467" class="Keyword">do</a>
    <a id="6474" href="TypeChecker.html#6474" class="Bound">ds&#39;</a> <a id="6478" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6480" href="TypeChecker.html#6079" class="Function">checkDecls</a> <a id="6491" href="TypeChecker.html#6456" class="Bound">ds</a>
    <a id="6498" href="TypeChecker.html#6498" class="Bound">ss&#39;</a> <a id="6502" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6504" href="TypeChecker.html#5283" class="Function">lift</a> <a id="6509" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6511" href="TypeChecker.html#3944" class="Function">checkStms</a> <a id="6521" href="TypeChecker.html#6459" class="Bound">ss</a>
    <a id="6528" href="TypeChecker.html#6528" class="Bound">e&#39;</a>  <a id="6532" href="Library.Monad.html#1002" class="Field Operator">←</a> <a id="6534" href="TypeChecker.html#5283" class="Function">lift</a> <a id="6539" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6541" href="TypeChecker.html#3825" class="Function">checkExp</a> <a id="6550" href="TypeChecker.html#6462" class="Bound">e</a> <a id="6552" href="AST.html#423" class="InductiveConstructor">int</a>
    <a id="6560" href="Library.Monad.html#1110" class="Function">return</a> <a id="6567" class="Symbol">(</a><a id="6568" href="WellTypedSyntax.html#1704" class="InductiveConstructor">program</a> <a id="6576" href="TypeChecker.html#6474" class="Bound">ds&#39;</a> <a id="6580" href="TypeChecker.html#6498" class="Bound">ss&#39;</a> <a id="6584" href="TypeChecker.html#6528" class="Bound">e&#39;</a><a id="6586" class="Symbol">)</a>

<a id="6589" class="Comment">-- Checking the program.</a>
<a id="6614" class="Comment">---------------------------------------------------------------------------</a>

<a id="checkProgram"></a><a id="6691" href="TypeChecker.html#6691" class="Function">checkProgram</a> <a id="6704" class="Symbol">:</a> <a id="6706" class="Symbol">(</a><a id="6707" href="TypeChecker.html#6707" class="Bound">prg</a> <a id="6711" class="Symbol">:</a> <a id="6713" href="AST.html#1530" class="Record">A.Program</a><a id="6722" class="Symbol">)</a> <a id="6724" class="Symbol">→</a> <a id="6726" href="Library.Error.html#170" class="Function">Error</a> <a id="6732" href="WellTypedSyntax.html#1670" class="Record">Program</a>
<a id="6740" href="TypeChecker.html#6691" class="Function">checkProgram</a> <a id="6753" href="TypeChecker.html#6753" class="Bound">prg</a> <a id="6757" class="Symbol">=</a> <a id="6759" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="6765" href="Library.Monad.html#284" class="Function Operator">&lt;$&gt;</a> <a id="6769" href="TypeChecker.html#6334" class="Function">CheckDeclarations.checkProgram</a> <a id="6800" href="TypeChecker.html#6753" class="Bound">prg</a> <a id="6804" class="Symbol">.</a><a id="6805" href="TypeChecker.html#4371" class="Field">runTCDecl</a> <a id="6815" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a>


<a id="6820" class="Comment">-- -}</a>
<a id="6826" class="Comment">-- -}</a>
<a id="6832" class="Comment">-- -}</a>
<a id="6838" class="Comment">-- -}</a>
<a id="6844" class="Comment">-- -}</a>
<a id="6850" class="Comment">-- -}</a>
</pre></body></html>