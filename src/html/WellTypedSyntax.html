<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>WellTypedSyntax</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">-- Intrinsically well-typed WHILE syntax.</a>

<a id="44" class="Keyword">module</a> <a id="51" href="WellTypedSyntax.html" class="Module">WellTypedSyntax</a> <a id="67" class="Keyword">where</a>

<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="Library.html" class="Module">Library</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="AST.html" class="Module">AST</a> <a id="110" class="Keyword">public</a> <a id="117" class="Keyword">using</a> <a id="123" class="Symbol">(</a><a id="124" href="AST.html#369" class="Datatype">Type</a><a id="128" class="Symbol">;</a> <a id="130" href="AST.html#388" class="InductiveConstructor">bool</a><a id="134" class="Symbol">;</a> <a id="136" href="AST.html#393" class="InductiveConstructor">int</a><a id="139" class="Symbol">;</a> <a id="141" href="AST.html#471" class="Datatype">Boolean</a><a id="148" class="Symbol">;</a> <a id="150" href="AST.html#493" class="InductiveConstructor">true</a><a id="154" class="Symbol">;</a> <a id="156" href="AST.html#498" class="InductiveConstructor">false</a><a id="161" class="Symbol">;</a> <a id="163" href="AST.html#2312" class="Function">PrintBoolean</a><a id="175" class="Symbol">)</a>

<a id="178" class="Comment">-- Variables are de Bruijn indices into the context, a list of types.</a>

<a id="Cxt"></a><a id="249" href="WellTypedSyntax.html#249" class="Function">Cxt</a> <a id="253" class="Symbol">=</a> <a id="255" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="260" href="AST.html#369" class="Datatype">Type</a>

<a id="Var"></a><a id="266" href="WellTypedSyntax.html#266" class="Function">Var</a> <a id="270" class="Symbol">:</a> <a id="272" class="Symbol">(</a><a id="273" href="WellTypedSyntax.html#273" class="Bound">Γ</a> <a id="275" class="Symbol">:</a> <a id="277" href="WellTypedSyntax.html#249" class="Function">Cxt</a><a id="280" class="Symbol">)</a> <a id="282" class="Symbol">(</a><a id="283" href="WellTypedSyntax.html#283" class="Bound">t</a> <a id="285" class="Symbol">:</a> <a id="287" href="AST.html#369" class="Datatype">Type</a><a id="291" class="Symbol">)</a> <a id="293" class="Symbol">→</a> <a id="295" class="PrimitiveType">Set</a>
<a id="299" href="WellTypedSyntax.html#266" class="Function">Var</a> <a id="303" href="WellTypedSyntax.html#303" class="Bound">Γ</a> <a id="305" href="WellTypedSyntax.html#305" class="Bound">t</a> <a id="307" class="Symbol">=</a> <a id="309" href="WellTypedSyntax.html#305" class="Bound">t</a> <a id="311" href="Data.List.Membership.Setoid.html#709" class="Function Operator">∈</a> <a id="313" href="WellTypedSyntax.html#303" class="Bound">Γ</a>

<a id="316" class="Comment">-- Binary Operators.</a>

<a id="338" class="Keyword">data</a> <a id="Op"></a><a id="343" href="WellTypedSyntax.html#343" class="Datatype">Op</a> <a id="346" class="Symbol">:</a> <a id="348" class="Symbol">(</a><a id="349" href="WellTypedSyntax.html#349" class="Bound">dom</a> <a id="353" href="WellTypedSyntax.html#353" class="Bound">codom</a> <a id="359" class="Symbol">:</a> <a id="361" href="AST.html#369" class="Datatype">Type</a><a id="365" class="Symbol">)</a> <a id="367" class="Symbol">→</a> <a id="369" class="PrimitiveType">Set</a> <a id="373" class="Keyword">where</a>
  <a id="Op.plus"></a><a id="381" href="WellTypedSyntax.html#381" class="InductiveConstructor">plus</a>  <a id="387" class="Symbol">:</a> <a id="389" href="WellTypedSyntax.html#343" class="Datatype">Op</a> <a id="392" href="AST.html#393" class="InductiveConstructor">int</a>  <a id="397" href="AST.html#393" class="InductiveConstructor">int</a>
  <a id="Op.gt"></a><a id="403" href="WellTypedSyntax.html#403" class="InductiveConstructor">gt</a>    <a id="409" class="Symbol">:</a> <a id="411" href="WellTypedSyntax.html#343" class="Datatype">Op</a> <a id="414" href="AST.html#393" class="InductiveConstructor">int</a>  <a id="419" href="AST.html#388" class="InductiveConstructor">bool</a>
  <a id="Op.and"></a><a id="426" href="WellTypedSyntax.html#426" class="InductiveConstructor">and</a>   <a id="432" class="Symbol">:</a> <a id="434" href="WellTypedSyntax.html#343" class="Datatype">Op</a> <a id="437" href="AST.html#388" class="InductiveConstructor">bool</a> <a id="442" href="AST.html#388" class="InductiveConstructor">bool</a>

<a id="448" class="Comment">-- Well-typed expressions: context is fixed.</a>

<a id="494" class="Keyword">data</a> <a id="Exp"></a><a id="499" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="503" class="Symbol">(</a><a id="504" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="506" class="Symbol">:</a> <a id="508" href="WellTypedSyntax.html#249" class="Function">Cxt</a><a id="511" class="Symbol">)</a> <a id="513" class="Symbol">:</a> <a id="515" href="AST.html#369" class="Datatype">Type</a> <a id="520" class="Symbol">→</a> <a id="522" class="PrimitiveType">Set</a> <a id="526" class="Keyword">where</a>
  <a id="534" class="Comment">-- Literals:</a>
  <a id="Exp.eInt"></a><a id="549" href="WellTypedSyntax.html#549" class="InductiveConstructor">eInt</a>  <a id="555" class="Symbol">:</a> <a id="557" class="Symbol">(</a><a id="558" href="WellTypedSyntax.html#558" class="Bound">i</a> <a id="560" class="Symbol">:</a> <a id="562" href="Agda.Builtin.Int.html#178" class="Datatype">ℤ</a><a id="563" class="Symbol">)</a>                                 <a id="597" class="Symbol">→</a> <a id="599" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="603" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="605" href="AST.html#393" class="InductiveConstructor">int</a>
  <a id="Exp.eBool"></a><a id="611" href="WellTypedSyntax.html#611" class="InductiveConstructor">eBool</a> <a id="617" class="Symbol">:</a> <a id="619" class="Symbol">(</a><a id="620" href="WellTypedSyntax.html#620" class="Bound">b</a> <a id="622" class="Symbol">:</a> <a id="624" href="AST.html#471" class="Datatype">Boolean</a><a id="631" class="Symbol">)</a>                           <a id="659" class="Symbol">→</a> <a id="661" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="665" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="667" href="AST.html#388" class="InductiveConstructor">bool</a>
  <a id="674" class="Comment">-- Operators:</a>
  <a id="Exp.eOp"></a><a id="690" href="WellTypedSyntax.html#690" class="InductiveConstructor">eOp</a>   <a id="696" class="Symbol">:</a> <a id="698" class="Symbol">∀{</a><a id="700" href="WellTypedSyntax.html#700" class="Bound">t</a> <a id="702" href="WellTypedSyntax.html#702" class="Bound">t&#39;</a><a id="704" class="Symbol">}</a> <a id="706" class="Symbol">(</a><a id="707" href="WellTypedSyntax.html#707" class="Bound">op</a> <a id="710" class="Symbol">:</a> <a id="712" href="WellTypedSyntax.html#343" class="Datatype">Op</a> <a id="715" href="WellTypedSyntax.html#700" class="Bound">t</a> <a id="717" href="WellTypedSyntax.html#702" class="Bound">t&#39;</a><a id="719" class="Symbol">)</a> <a id="721" class="Symbol">(</a><a id="722" href="WellTypedSyntax.html#722" class="Bound">e</a> <a id="724" href="WellTypedSyntax.html#724" class="Bound">e&#39;</a> <a id="727" class="Symbol">:</a> <a id="729" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="733" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="735" href="WellTypedSyntax.html#700" class="Bound">t</a><a id="736" class="Symbol">)</a> <a id="738" class="Symbol">→</a> <a id="740" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="744" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="746" href="WellTypedSyntax.html#702" class="Bound">t&#39;</a>
  <a id="751" class="Comment">-- Variables:</a>
  <a id="Exp.eVar"></a><a id="767" href="WellTypedSyntax.html#767" class="InductiveConstructor">eVar</a>  <a id="773" class="Symbol">:</a> <a id="775" class="Symbol">∀{</a><a id="777" href="WellTypedSyntax.html#777" class="Bound">t</a><a id="778" class="Symbol">}</a>    <a id="783" class="Symbol">(</a><a id="784" href="WellTypedSyntax.html#784" class="Bound">x</a> <a id="786" class="Symbol">:</a> <a id="788" href="WellTypedSyntax.html#266" class="Function">Var</a> <a id="792" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="794" href="WellTypedSyntax.html#777" class="Bound">t</a><a id="795" class="Symbol">)</a>                   <a id="815" class="Symbol">→</a> <a id="817" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="821" href="WellTypedSyntax.html#504" class="Bound">Γ</a> <a id="823" href="WellTypedSyntax.html#777" class="Bound">t</a>

<a id="826" class="Comment">-- Well-typed declarations (extending the context).</a>

<a id="879" class="Keyword">data</a> <a id="Decl"></a><a id="884" href="WellTypedSyntax.html#884" class="Datatype">Decl</a> <a id="889" class="Symbol">(</a><a id="890" href="WellTypedSyntax.html#890" class="Bound">Γ</a> <a id="892" class="Symbol">:</a> <a id="894" href="WellTypedSyntax.html#249" class="Function">Cxt</a><a id="897" class="Symbol">)</a> <a id="899" class="Symbol">(</a><a id="900" href="WellTypedSyntax.html#900" class="Bound">t</a> <a id="902" class="Symbol">:</a> <a id="904" href="AST.html#369" class="Datatype">Type</a><a id="908" class="Symbol">)</a> <a id="910" class="Symbol">:</a> <a id="912" class="PrimitiveType">Set</a> <a id="916" class="Keyword">where</a>
  <a id="Decl.dInit"></a><a id="924" href="WellTypedSyntax.html#924" class="InductiveConstructor">dInit</a> <a id="930" class="Symbol">:</a> <a id="932" class="Symbol">(</a><a id="933" href="WellTypedSyntax.html#933" class="Bound">e</a> <a id="935" class="Symbol">:</a> <a id="937" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="941" href="WellTypedSyntax.html#890" class="Bound">Γ</a> <a id="943" href="WellTypedSyntax.html#900" class="Bound">t</a><a id="944" class="Symbol">)</a> <a id="946" class="Symbol">→</a> <a id="948" href="WellTypedSyntax.html#884" class="Datatype">Decl</a> <a id="953" href="WellTypedSyntax.html#890" class="Bound">Γ</a> <a id="955" href="WellTypedSyntax.html#900" class="Bound">t</a>

<a id="958" class="Keyword">data</a> <a id="Decls"></a><a id="963" href="WellTypedSyntax.html#963" class="Datatype">Decls</a> <a id="969" class="Symbol">(</a><a id="970" href="WellTypedSyntax.html#970" class="Bound">Γ</a> <a id="972" class="Symbol">:</a> <a id="974" href="WellTypedSyntax.html#249" class="Function">Cxt</a><a id="977" class="Symbol">)</a> <a id="979" class="Symbol">:</a> <a id="981" href="WellTypedSyntax.html#249" class="Function">Cxt</a> <a id="985" class="Symbol">→</a> <a id="987" class="PrimitiveType">Set</a> <a id="991" class="Keyword">where</a>
  <a id="Decls.[]"></a><a id="999" href="WellTypedSyntax.html#999" class="InductiveConstructor">[]</a>  <a id="1003" class="Symbol">:</a> <a id="1005" href="WellTypedSyntax.html#963" class="Datatype">Decls</a> <a id="1011" href="WellTypedSyntax.html#970" class="Bound">Γ</a> <a id="1013" href="WellTypedSyntax.html#970" class="Bound">Γ</a>
  <a id="Decls._∷_"></a><a id="1017" href="WellTypedSyntax.html#1017" class="InductiveConstructor Operator">_∷_</a> <a id="1021" class="Symbol">:</a> <a id="1023" class="Symbol">∀{</a><a id="1025" href="WellTypedSyntax.html#1025" class="Bound">t</a> <a id="1027" href="WellTypedSyntax.html#1027" class="Bound">Γ′</a><a id="1029" class="Symbol">}</a> <a id="1031" class="Symbol">(</a><a id="1032" href="WellTypedSyntax.html#1032" class="Bound">s</a> <a id="1034" class="Symbol">:</a> <a id="1036" href="WellTypedSyntax.html#884" class="Datatype">Decl</a> <a id="1041" href="WellTypedSyntax.html#970" class="Bound">Γ</a> <a id="1043" href="WellTypedSyntax.html#1025" class="Bound">t</a><a id="1044" class="Symbol">)</a> <a id="1046" class="Symbol">(</a><a id="1047" href="WellTypedSyntax.html#1047" class="Bound">ss</a> <a id="1050" class="Symbol">:</a> <a id="1052" href="WellTypedSyntax.html#963" class="Datatype">Decls</a> <a id="1058" class="Symbol">(</a><a id="1059" href="WellTypedSyntax.html#1025" class="Bound">t</a> <a id="1061" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1063" href="WellTypedSyntax.html#970" class="Bound">Γ</a><a id="1064" class="Symbol">)</a> <a id="1066" href="WellTypedSyntax.html#1027" class="Bound">Γ′</a><a id="1068" class="Symbol">)</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="WellTypedSyntax.html#963" class="Datatype">Decls</a> <a id="1078" href="WellTypedSyntax.html#970" class="Bound">Γ</a> <a id="1080" href="WellTypedSyntax.html#1027" class="Bound">Γ′</a>

<a id="1084" class="Comment">-- Well-typed statements.</a>

<a id="1111" class="Keyword">mutual</a>

  <a id="1121" class="Keyword">data</a> <a id="Stm"></a><a id="1126" href="WellTypedSyntax.html#1126" class="Datatype">Stm</a> <a id="1130" class="Symbol">(</a><a id="1131" href="WellTypedSyntax.html#1131" class="Bound">Γ</a> <a id="1133" class="Symbol">:</a> <a id="1135" href="WellTypedSyntax.html#249" class="Function">Cxt</a><a id="1138" class="Symbol">)</a> <a id="1140" class="Symbol">:</a> <a id="1142" class="PrimitiveType">Set</a> <a id="1146" class="Keyword">where</a>
    <a id="Stm.sAss"></a><a id="1156" href="WellTypedSyntax.html#1156" class="InductiveConstructor">sAss</a>    <a id="1164" class="Symbol">:</a> <a id="1166" class="Symbol">∀{</a><a id="1168" href="WellTypedSyntax.html#1168" class="Bound">t</a><a id="1169" class="Symbol">}</a> <a id="1171" class="Symbol">(</a><a id="1172" href="WellTypedSyntax.html#1172" class="Bound">x</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="WellTypedSyntax.html#266" class="Function">Var</a> <a id="1180" href="WellTypedSyntax.html#1131" class="Bound">Γ</a> <a id="1182" href="WellTypedSyntax.html#1168" class="Bound">t</a><a id="1183" class="Symbol">)</a> <a id="1185" class="Symbol">(</a><a id="1186" href="WellTypedSyntax.html#1186" class="Bound">e</a> <a id="1188" class="Symbol">:</a> <a id="1190" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="1194" href="WellTypedSyntax.html#1131" class="Bound">Γ</a> <a id="1196" href="WellTypedSyntax.html#1168" class="Bound">t</a><a id="1197" class="Symbol">)</a>               <a id="1213" class="Symbol">→</a> <a id="1215" href="WellTypedSyntax.html#1126" class="Datatype">Stm</a> <a id="1219" href="WellTypedSyntax.html#1131" class="Bound">Γ</a>
    <a id="Stm.sWhile"></a><a id="1225" href="WellTypedSyntax.html#1225" class="InductiveConstructor">sWhile</a>  <a id="1233" class="Symbol">:</a> <a id="1235" class="Symbol">∀</a> <a id="1237" class="Symbol">(</a><a id="1238" href="WellTypedSyntax.html#1238" class="Bound">e</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="1246" href="WellTypedSyntax.html#1131" class="Bound">Γ</a> <a id="1248" href="AST.html#388" class="InductiveConstructor">bool</a><a id="1252" class="Symbol">)</a> <a id="1254" class="Symbol">(</a><a id="1255" href="WellTypedSyntax.html#1255" class="Bound">s</a>  <a id="1258" class="Symbol">:</a> <a id="1260" href="WellTypedSyntax.html#1362" class="Function">Stms</a> <a id="1265" href="WellTypedSyntax.html#1131" class="Bound">Γ</a><a id="1266" class="Symbol">)</a>               <a id="1282" class="Symbol">→</a> <a id="1284" href="WellTypedSyntax.html#1126" class="Datatype">Stm</a> <a id="1288" href="WellTypedSyntax.html#1131" class="Bound">Γ</a>
    <a id="Stm.sIfElse"></a><a id="1294" href="WellTypedSyntax.html#1294" class="InductiveConstructor">sIfElse</a> <a id="1302" class="Symbol">:</a> <a id="1304" class="Symbol">∀</a> <a id="1306" class="Symbol">(</a><a id="1307" href="WellTypedSyntax.html#1307" class="Bound">e</a> <a id="1309" class="Symbol">:</a> <a id="1311" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="1315" href="WellTypedSyntax.html#1131" class="Bound">Γ</a> <a id="1317" href="AST.html#388" class="InductiveConstructor">bool</a><a id="1321" class="Symbol">)</a> <a id="1323" class="Symbol">(</a><a id="1324" href="WellTypedSyntax.html#1324" class="Bound">s₁</a> <a id="1327" class="Symbol">:</a> <a id="1329" href="WellTypedSyntax.html#1362" class="Function">Stms</a> <a id="1334" href="WellTypedSyntax.html#1131" class="Bound">Γ</a><a id="1335" class="Symbol">)</a> <a id="1337" class="Symbol">(</a><a id="1338" href="WellTypedSyntax.html#1338" class="Bound">s₂</a> <a id="1341" class="Symbol">:</a> <a id="1343" href="WellTypedSyntax.html#1362" class="Function">Stms</a> <a id="1348" href="WellTypedSyntax.html#1131" class="Bound">Γ</a><a id="1349" class="Symbol">)</a> <a id="1351" class="Symbol">→</a> <a id="1353" href="WellTypedSyntax.html#1126" class="Datatype">Stm</a> <a id="1357" href="WellTypedSyntax.html#1131" class="Bound">Γ</a>

  <a id="Stms"></a><a id="1362" href="WellTypedSyntax.html#1362" class="Function">Stms</a> <a id="1367" class="Symbol">:</a> <a id="1369" href="WellTypedSyntax.html#249" class="Function">Cxt</a> <a id="1373" class="Symbol">→</a> <a id="1375" class="PrimitiveType">Set</a>
  <a id="1381" href="WellTypedSyntax.html#1362" class="Function">Stms</a> <a id="1386" href="WellTypedSyntax.html#1386" class="Bound">Γ</a> <a id="1388" class="Symbol">=</a> <a id="1390" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1395" class="Symbol">(</a><a id="1396" href="WellTypedSyntax.html#1126" class="Datatype">Stm</a> <a id="1400" href="WellTypedSyntax.html#1386" class="Bound">Γ</a><a id="1401" class="Symbol">)</a>

<a id="1404" class="Comment">-- A program is a list of statements and a final expression.</a>

<a id="1466" class="Keyword">record</a> <a id="Program"></a><a id="1473" href="WellTypedSyntax.html#1473" class="Record">Program</a> <a id="1481" class="Symbol">:</a> <a id="1483" class="PrimitiveType">Set</a> <a id="1487" class="Keyword">where</a>
  <a id="1495" class="Keyword">constructor</a> <a id="Program.program"></a><a id="1507" href="WellTypedSyntax.html#1507" class="InductiveConstructor">program</a>
  <a id="1517" class="Keyword">field</a>
    <a id="1527" class="Symbol">{</a><a id="Program.Γ"></a><a id="1528" href="WellTypedSyntax.html#1528" class="Field">Γ</a><a id="1529" class="Symbol">}</a>      <a id="1536" class="Symbol">:</a> <a id="1538" href="WellTypedSyntax.html#249" class="Function">Cxt</a>
    <a id="Program.theDecls"></a><a id="1546" href="WellTypedSyntax.html#1546" class="Field">theDecls</a> <a id="1555" class="Symbol">:</a> <a id="1557" href="WellTypedSyntax.html#963" class="Datatype">Decls</a> <a id="1563" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1566" href="WellTypedSyntax.html#1528" class="Field">Γ</a>
    <a id="Program.theStms"></a><a id="1572" href="WellTypedSyntax.html#1572" class="Field">theStms</a>  <a id="1581" class="Symbol">:</a> <a id="1583" href="WellTypedSyntax.html#1362" class="Function">Stms</a> <a id="1588" href="WellTypedSyntax.html#1528" class="Field">Γ</a>
    <a id="Program.theMain"></a><a id="1594" href="WellTypedSyntax.html#1594" class="Field">theMain</a>  <a id="1603" class="Symbol">:</a> <a id="1605" href="WellTypedSyntax.html#499" class="Datatype">Exp</a> <a id="1609" href="WellTypedSyntax.html#1528" class="Field">Γ</a> <a id="1611" href="AST.html#393" class="InductiveConstructor">int</a>

<a id="1616" class="Keyword">open</a> <a id="1621" href="WellTypedSyntax.html#1473" class="Module">Program</a> <a id="1629" class="Keyword">public</a>


<a id="1638" class="Comment">-- -}</a>
</pre></body></html>