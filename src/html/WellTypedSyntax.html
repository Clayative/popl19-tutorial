<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>WellTypedSyntax</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Intrinsically well-typed WHILE syntax.</a>
<a id="43" class="Symbol">{-#</a> <a id="47" class="Keyword">OPTIONS</a> <a id="55" class="Pragma">--sized-types</a> <a id="69" class="Symbol">#-}</a>

<a id="74" class="Keyword">module</a> <a id="81" href="WellTypedSyntax.html" class="Module">WellTypedSyntax</a> <a id="97" class="Keyword">where</a>

<a id="104" class="Keyword">open</a> <a id="109" class="Keyword">import</a> <a id="116" href="Library.html" class="Module">Library</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="AST.html" class="Module">AST</a> <a id="140" class="Keyword">public</a> <a id="147" class="Keyword">using</a> <a id="153" class="Symbol">(</a><a id="154" href="AST.html#399" class="Datatype">Type</a><a id="158" class="Symbol">;</a> <a id="160" href="AST.html#418" class="InductiveConstructor">bool</a><a id="164" class="Symbol">;</a> <a id="166" href="AST.html#423" class="InductiveConstructor">int</a><a id="169" class="Symbol">;</a> <a id="171" href="AST.html#501" class="Datatype">Boolean</a><a id="178" class="Symbol">;</a> <a id="180" href="AST.html#523" class="InductiveConstructor">true</a><a id="184" class="Symbol">;</a> <a id="186" href="AST.html#528" class="InductiveConstructor">false</a><a id="191" class="Symbol">;</a> <a id="193" href="AST.html#2342" class="Function">PrintBoolean</a><a id="205" class="Symbol">)</a>

<a id="208" class="Comment">-- Variables are de Bruijn indices into the context, a list of types.</a>

<a id="Cxt"></a><a id="279" href="WellTypedSyntax.html#279" class="Function">Cxt</a> <a id="283" class="Symbol">=</a> <a id="285" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="290" href="AST.html#399" class="Datatype">Type</a>

<a id="Var"></a><a id="296" href="WellTypedSyntax.html#296" class="Function">Var</a> <a id="300" class="Symbol">:</a> <a id="302" class="Symbol">(</a><a id="303" href="WellTypedSyntax.html#303" class="Bound">Γ</a> <a id="305" class="Symbol">:</a> <a id="307" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="310" class="Symbol">)</a> <a id="312" class="Symbol">(</a><a id="313" href="WellTypedSyntax.html#313" class="Bound">t</a> <a id="315" class="Symbol">:</a> <a id="317" href="AST.html#399" class="Datatype">Type</a><a id="321" class="Symbol">)</a> <a id="323" class="Symbol">→</a> <a id="325" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="329" href="WellTypedSyntax.html#296" class="Function">Var</a> <a id="333" href="WellTypedSyntax.html#333" class="Bound">Γ</a> <a id="335" href="WellTypedSyntax.html#335" class="Bound">t</a> <a id="337" class="Symbol">=</a> <a id="339" href="WellTypedSyntax.html#335" class="Bound">t</a> <a id="341" href="Data.List.Membership.Setoid.html#925" class="Function Operator">∈</a> <a id="343" href="WellTypedSyntax.html#333" class="Bound">Γ</a>

<a id="346" class="Comment">-- Binary Operators.</a>

<a id="368" class="Keyword">data</a> <a id="Op"></a><a id="373" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="376" class="Symbol">:</a> <a id="378" class="Symbol">(</a><a id="379" href="WellTypedSyntax.html#379" class="Bound">dom</a> <a id="383" href="WellTypedSyntax.html#383" class="Bound">codom</a> <a id="389" class="Symbol">:</a> <a id="391" href="AST.html#399" class="Datatype">Type</a><a id="395" class="Symbol">)</a> <a id="397" class="Symbol">→</a> <a id="399" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="403" class="Keyword">where</a>
  <a id="Op.plus"></a><a id="411" href="WellTypedSyntax.html#411" class="InductiveConstructor">plus</a>  <a id="417" class="Symbol">:</a> <a id="419" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="422" href="AST.html#423" class="InductiveConstructor">int</a>  <a id="427" href="AST.html#423" class="InductiveConstructor">int</a>
  <a id="Op.gt"></a><a id="433" href="WellTypedSyntax.html#433" class="InductiveConstructor">gt</a>    <a id="439" class="Symbol">:</a> <a id="441" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="444" href="AST.html#423" class="InductiveConstructor">int</a>  <a id="449" href="AST.html#418" class="InductiveConstructor">bool</a>
  <a id="Op.and"></a><a id="456" href="WellTypedSyntax.html#456" class="InductiveConstructor">and</a>   <a id="462" class="Symbol">:</a> <a id="464" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="467" href="AST.html#418" class="InductiveConstructor">bool</a> <a id="472" href="AST.html#418" class="InductiveConstructor">bool</a>

<a id="478" class="Comment">-- Well-typed expressions: context is fixed.</a>

<a id="524" class="Keyword">data</a> <a id="Exp"></a><a id="529" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="533" class="Symbol">(</a><a id="534" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="536" class="Symbol">:</a> <a id="538" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="541" class="Symbol">)</a> <a id="543" class="Symbol">:</a> <a id="545" href="AST.html#399" class="Datatype">Type</a> <a id="550" class="Symbol">→</a> <a id="552" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="556" class="Keyword">where</a>
  <a id="564" class="Comment">-- Literals:</a>
  <a id="Exp.eInt"></a><a id="579" href="WellTypedSyntax.html#579" class="InductiveConstructor">eInt</a>  <a id="585" class="Symbol">:</a> <a id="587" class="Symbol">(</a><a id="588" href="WellTypedSyntax.html#588" class="Bound">i</a> <a id="590" class="Symbol">:</a> <a id="592" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="593" class="Symbol">)</a>                                 <a id="627" class="Symbol">→</a> <a id="629" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="633" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="635" href="AST.html#423" class="InductiveConstructor">int</a>
  <a id="Exp.eBool"></a><a id="641" href="WellTypedSyntax.html#641" class="InductiveConstructor">eBool</a> <a id="647" class="Symbol">:</a> <a id="649" class="Symbol">(</a><a id="650" href="WellTypedSyntax.html#650" class="Bound">b</a> <a id="652" class="Symbol">:</a> <a id="654" href="AST.html#501" class="Datatype">Boolean</a><a id="661" class="Symbol">)</a>                           <a id="689" class="Symbol">→</a> <a id="691" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="695" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="697" href="AST.html#418" class="InductiveConstructor">bool</a>
  <a id="704" class="Comment">-- Operators:</a>
  <a id="Exp.eOp"></a><a id="720" href="WellTypedSyntax.html#720" class="InductiveConstructor">eOp</a>   <a id="726" class="Symbol">:</a> <a id="728" class="Symbol">∀{</a><a id="730" href="WellTypedSyntax.html#730" class="Bound">t</a> <a id="732" href="WellTypedSyntax.html#732" class="Bound">t&#39;</a><a id="734" class="Symbol">}</a> <a id="736" class="Symbol">(</a><a id="737" href="WellTypedSyntax.html#737" class="Bound">op</a> <a id="740" class="Symbol">:</a> <a id="742" href="WellTypedSyntax.html#373" class="Datatype">Op</a> <a id="745" href="WellTypedSyntax.html#730" class="Bound">t</a> <a id="747" href="WellTypedSyntax.html#732" class="Bound">t&#39;</a><a id="749" class="Symbol">)</a> <a id="751" class="Symbol">(</a><a id="752" href="WellTypedSyntax.html#752" class="Bound">e</a> <a id="754" href="WellTypedSyntax.html#754" class="Bound">e&#39;</a> <a id="757" class="Symbol">:</a> <a id="759" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="763" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="765" href="WellTypedSyntax.html#730" class="Bound">t</a><a id="766" class="Symbol">)</a> <a id="768" class="Symbol">→</a> <a id="770" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="774" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="776" href="WellTypedSyntax.html#732" class="Bound">t&#39;</a>
  <a id="781" class="Comment">-- Variables:</a>
  <a id="Exp.eVar"></a><a id="797" href="WellTypedSyntax.html#797" class="InductiveConstructor">eVar</a>  <a id="803" class="Symbol">:</a> <a id="805" class="Symbol">∀{</a><a id="807" href="WellTypedSyntax.html#807" class="Bound">t</a><a id="808" class="Symbol">}</a>    <a id="813" class="Symbol">(</a><a id="814" href="WellTypedSyntax.html#814" class="Bound">x</a> <a id="816" class="Symbol">:</a> <a id="818" href="WellTypedSyntax.html#296" class="Function">Var</a> <a id="822" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="824" href="WellTypedSyntax.html#807" class="Bound">t</a><a id="825" class="Symbol">)</a>                   <a id="845" class="Symbol">→</a> <a id="847" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="851" href="WellTypedSyntax.html#534" class="Bound">Γ</a> <a id="853" href="WellTypedSyntax.html#807" class="Bound">t</a>

<a id="856" class="Comment">-- Well-typed declarations (extending the context).</a>

<a id="909" class="Keyword">data</a> <a id="Decl"></a><a id="914" href="WellTypedSyntax.html#914" class="Datatype">Decl</a> <a id="919" class="Symbol">(</a><a id="920" href="WellTypedSyntax.html#920" class="Bound">Γ</a> <a id="922" class="Symbol">:</a> <a id="924" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="927" class="Symbol">)</a> <a id="929" class="Symbol">(</a><a id="930" href="WellTypedSyntax.html#930" class="Bound">t</a> <a id="932" class="Symbol">:</a> <a id="934" href="AST.html#399" class="Datatype">Type</a><a id="938" class="Symbol">)</a> <a id="940" class="Symbol">:</a> <a id="942" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="946" class="Keyword">where</a>
  <a id="Decl.dInit"></a><a id="954" href="WellTypedSyntax.html#954" class="InductiveConstructor">dInit</a> <a id="960" class="Symbol">:</a> <a id="962" class="Symbol">(</a><a id="963" href="WellTypedSyntax.html#963" class="Bound">e</a> <a id="965" class="Symbol">:</a> <a id="967" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="971" href="WellTypedSyntax.html#920" class="Bound">Γ</a> <a id="973" href="WellTypedSyntax.html#930" class="Bound">t</a><a id="974" class="Symbol">)</a> <a id="976" class="Symbol">→</a> <a id="978" href="WellTypedSyntax.html#914" class="Datatype">Decl</a> <a id="983" href="WellTypedSyntax.html#920" class="Bound">Γ</a> <a id="985" href="WellTypedSyntax.html#930" class="Bound">t</a>

<a id="988" class="Keyword">data</a> <a id="Decls"></a><a id="993" href="WellTypedSyntax.html#993" class="Datatype">Decls</a> <a id="999" class="Symbol">(</a><a id="1000" href="WellTypedSyntax.html#1000" class="Bound">Γ</a> <a id="1002" class="Symbol">:</a> <a id="1004" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="1007" class="Symbol">)</a> <a id="1009" class="Symbol">:</a> <a id="1011" href="WellTypedSyntax.html#279" class="Function">Cxt</a> <a id="1015" class="Symbol">→</a> <a id="1017" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1021" class="Keyword">where</a>
  <a id="Decls.[]"></a><a id="1029" href="WellTypedSyntax.html#1029" class="InductiveConstructor">[]</a>  <a id="1033" class="Symbol">:</a> <a id="1035" href="WellTypedSyntax.html#993" class="Datatype">Decls</a> <a id="1041" href="WellTypedSyntax.html#1000" class="Bound">Γ</a> <a id="1043" href="WellTypedSyntax.html#1000" class="Bound">Γ</a>
  <a id="Decls._∷_"></a><a id="1047" href="WellTypedSyntax.html#1047" class="InductiveConstructor Operator">_∷_</a> <a id="1051" class="Symbol">:</a> <a id="1053" class="Symbol">∀{</a><a id="1055" href="WellTypedSyntax.html#1055" class="Bound">t</a> <a id="1057" href="WellTypedSyntax.html#1057" class="Bound">Γ′</a><a id="1059" class="Symbol">}</a> <a id="1061" class="Symbol">(</a><a id="1062" href="WellTypedSyntax.html#1062" class="Bound">s</a> <a id="1064" class="Symbol">:</a> <a id="1066" href="WellTypedSyntax.html#914" class="Datatype">Decl</a> <a id="1071" href="WellTypedSyntax.html#1000" class="Bound">Γ</a> <a id="1073" href="WellTypedSyntax.html#1055" class="Bound">t</a><a id="1074" class="Symbol">)</a> <a id="1076" class="Symbol">(</a><a id="1077" href="WellTypedSyntax.html#1077" class="Bound">ss</a> <a id="1080" class="Symbol">:</a> <a id="1082" href="WellTypedSyntax.html#993" class="Datatype">Decls</a> <a id="1088" class="Symbol">(</a><a id="1089" href="WellTypedSyntax.html#1055" class="Bound">t</a> <a id="1091" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1093" href="WellTypedSyntax.html#1000" class="Bound">Γ</a><a id="1094" class="Symbol">)</a> <a id="1096" href="WellTypedSyntax.html#1057" class="Bound">Γ′</a><a id="1098" class="Symbol">)</a> <a id="1100" class="Symbol">→</a> <a id="1102" href="WellTypedSyntax.html#993" class="Datatype">Decls</a> <a id="1108" href="WellTypedSyntax.html#1000" class="Bound">Γ</a> <a id="1110" href="WellTypedSyntax.html#1057" class="Bound">Γ′</a>

<a id="1114" class="Comment">-- Well-typed statements.</a>

<a id="1141" class="Keyword">mutual</a>

  <a id="1151" class="Keyword">data</a> <a id="Stm"></a><a id="1156" href="WellTypedSyntax.html#1156" class="Datatype">Stm</a> <a id="1160" class="Symbol">(</a><a id="1161" href="WellTypedSyntax.html#1161" class="Bound">Γ</a> <a id="1163" class="Symbol">:</a> <a id="1165" href="WellTypedSyntax.html#279" class="Function">Cxt</a><a id="1168" class="Symbol">)</a> <a id="1170" class="Symbol">:</a> <a id="1172" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1176" class="Keyword">where</a>
    <a id="Stm.sAss"></a><a id="1186" href="WellTypedSyntax.html#1186" class="InductiveConstructor">sAss</a>    <a id="1194" class="Symbol">:</a> <a id="1196" class="Symbol">∀{</a><a id="1198" href="WellTypedSyntax.html#1198" class="Bound">t</a><a id="1199" class="Symbol">}</a> <a id="1201" class="Symbol">(</a><a id="1202" href="WellTypedSyntax.html#1202" class="Bound">x</a> <a id="1204" class="Symbol">:</a> <a id="1206" href="WellTypedSyntax.html#296" class="Function">Var</a> <a id="1210" href="WellTypedSyntax.html#1161" class="Bound">Γ</a> <a id="1212" href="WellTypedSyntax.html#1198" class="Bound">t</a><a id="1213" class="Symbol">)</a> <a id="1215" class="Symbol">(</a><a id="1216" href="WellTypedSyntax.html#1216" class="Bound">e</a> <a id="1218" class="Symbol">:</a> <a id="1220" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="1224" href="WellTypedSyntax.html#1161" class="Bound">Γ</a> <a id="1226" href="WellTypedSyntax.html#1198" class="Bound">t</a><a id="1227" class="Symbol">)</a>               <a id="1243" class="Symbol">→</a> <a id="1245" href="WellTypedSyntax.html#1156" class="Datatype">Stm</a> <a id="1249" href="WellTypedSyntax.html#1161" class="Bound">Γ</a>
    <a id="Stm.sWhile"></a><a id="1255" href="WellTypedSyntax.html#1255" class="InductiveConstructor">sWhile</a>  <a id="1263" class="Symbol">:</a> <a id="1265" class="Symbol">∀</a> <a id="1267" class="Symbol">(</a><a id="1268" href="WellTypedSyntax.html#1268" class="Bound">e</a> <a id="1270" class="Symbol">:</a> <a id="1272" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="1276" href="WellTypedSyntax.html#1161" class="Bound">Γ</a> <a id="1278" href="AST.html#418" class="InductiveConstructor">bool</a><a id="1282" class="Symbol">)</a> <a id="1284" class="Symbol">(</a><a id="1285" href="WellTypedSyntax.html#1285" class="Bound">s</a>  <a id="1288" class="Symbol">:</a> <a id="1290" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="1295" href="WellTypedSyntax.html#1161" class="Bound">Γ</a><a id="1296" class="Symbol">)</a>               <a id="1312" class="Symbol">→</a> <a id="1314" href="WellTypedSyntax.html#1156" class="Datatype">Stm</a> <a id="1318" href="WellTypedSyntax.html#1161" class="Bound">Γ</a>
    <a id="Stm.sIfElse"></a><a id="1324" href="WellTypedSyntax.html#1324" class="InductiveConstructor">sIfElse</a> <a id="1332" class="Symbol">:</a> <a id="1334" class="Symbol">∀</a> <a id="1336" class="Symbol">(</a><a id="1337" href="WellTypedSyntax.html#1337" class="Bound">e</a> <a id="1339" class="Symbol">:</a> <a id="1341" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="1345" href="WellTypedSyntax.html#1161" class="Bound">Γ</a> <a id="1347" href="AST.html#418" class="InductiveConstructor">bool</a><a id="1351" class="Symbol">)</a> <a id="1353" class="Symbol">(</a><a id="1354" href="WellTypedSyntax.html#1354" class="Bound">s₁</a> <a id="1357" class="Symbol">:</a> <a id="1359" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="1364" href="WellTypedSyntax.html#1161" class="Bound">Γ</a><a id="1365" class="Symbol">)</a> <a id="1367" class="Symbol">(</a><a id="1368" href="WellTypedSyntax.html#1368" class="Bound">s₂</a> <a id="1371" class="Symbol">:</a> <a id="1373" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="1378" href="WellTypedSyntax.html#1161" class="Bound">Γ</a><a id="1379" class="Symbol">)</a> <a id="1381" class="Symbol">→</a> <a id="1383" href="WellTypedSyntax.html#1156" class="Datatype">Stm</a> <a id="1387" href="WellTypedSyntax.html#1161" class="Bound">Γ</a>

  <a id="Stms"></a><a id="1392" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="1397" class="Symbol">:</a> <a id="1399" href="WellTypedSyntax.html#279" class="Function">Cxt</a> <a id="1403" class="Symbol">→</a> <a id="1405" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="1411" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="1416" href="WellTypedSyntax.html#1416" class="Bound">Γ</a> <a id="1418" class="Symbol">=</a> <a id="1420" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1425" class="Symbol">(</a><a id="1426" href="WellTypedSyntax.html#1156" class="Datatype">Stm</a> <a id="1430" href="WellTypedSyntax.html#1416" class="Bound">Γ</a><a id="1431" class="Symbol">)</a>

<a id="1434" class="Comment">-- A program is a list of statements and a final expression.</a>

<a id="1496" class="Keyword">record</a> <a id="Program"></a><a id="1503" href="WellTypedSyntax.html#1503" class="Record">Program</a> <a id="1511" class="Symbol">:</a> <a id="1513" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1517" class="Keyword">where</a>
  <a id="1525" class="Keyword">constructor</a> <a id="program"></a><a id="1537" href="WellTypedSyntax.html#1537" class="InductiveConstructor">program</a>
  <a id="1547" class="Keyword">field</a>
    <a id="1557" class="Symbol">{</a><a id="Program.Γ"></a><a id="1558" href="WellTypedSyntax.html#1558" class="Field">Γ</a><a id="1559" class="Symbol">}</a>      <a id="1566" class="Symbol">:</a> <a id="1568" href="WellTypedSyntax.html#279" class="Function">Cxt</a>
    <a id="Program.theDecls"></a><a id="1576" href="WellTypedSyntax.html#1576" class="Field">theDecls</a> <a id="1585" class="Symbol">:</a> <a id="1587" href="WellTypedSyntax.html#993" class="Datatype">Decls</a> <a id="1593" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1596" href="WellTypedSyntax.html#1558" class="Field">Γ</a>
    <a id="Program.theStms"></a><a id="1602" href="WellTypedSyntax.html#1602" class="Field">theStms</a>  <a id="1611" class="Symbol">:</a> <a id="1613" href="WellTypedSyntax.html#1392" class="Function">Stms</a> <a id="1618" href="WellTypedSyntax.html#1558" class="Field">Γ</a>
    <a id="Program.theMain"></a><a id="1624" href="WellTypedSyntax.html#1624" class="Field">theMain</a>  <a id="1633" class="Symbol">:</a> <a id="1635" href="WellTypedSyntax.html#529" class="Datatype">Exp</a> <a id="1639" href="WellTypedSyntax.html#1558" class="Field">Γ</a> <a id="1641" href="AST.html#423" class="InductiveConstructor">int</a>

<a id="1646" class="Keyword">open</a> <a id="1651" href="WellTypedSyntax.html#1503" class="Module">Program</a> <a id="1659" class="Keyword">public</a>


<a id="1668" class="Comment">-- -}</a>
</pre></body></html>